tinymce.PluginManager.add("themifyMenu",function(d,l){function h(){var a=d.settings.color_picker_callback;if(a)return function(){var c=this;a.call(d,function(a){c.value(a).fire("change")},c.value())}}function f(a){return{text:a.label,body:{type:a.id},onclick:function(){if(jQuery.isEmptyObject(a.fields)){var c={};c.selectedContent=d.selection.getContent();var k=wp.template("themify-shortcode-"+a.id);d.insertContent(k(c))}else{var g=[];jQuery.each(a.fields,function(a,b){"colorbox"==b.type?b.onaction=
h():"image"==b.type?b={type:"container",label:b.label,layout:"flex",direction:"row",items:[{type:"textbox",name:b.name},{type:"button",text:b.text,onclick:function(){var a=jQuery(this.$el),b=wp.media.frames.file_frame=wp.media({multiple:!1});b.on("select",function(){var c=b.state().get("selection").first().toJSON();a.prev().val(c.url)});b.open()}}]}:"iconpicker"==b.type&&(b={type:"container",label:b.label,layout:"flex",direction:"row",items:[{type:"textbox",name:b.name},{type:"button",text:b.text,
onclick:function(){var b=jQuery(this.$el);if(document.getElementById("themify_builder_site_canvas_iframe"))var a=document.getElementById("themify_builder_site_canvas_iframe").contentWindow.Themify_Icons;a.target=b.prev();a.showLightbox(a.target.val())}}]});g.push(b)});d.windowManager.open({title:a.label,body:g,onSubmit:function(c){c=this.toJSON();c.selectedContent=d.selection.getContent();var b=wp.template("themify-shortcode-"+a.id);d.insertContent(b(c))}})}}}}var e=[];jQuery.each(themifyEditor.shortcodes,
function(a,c){c.id=a;if("object"==typeof c.menu){var d=[];jQuery.each(c.menu,function(a,c){c.id=a;d.push(f(c))});e.push({text:c.label,menu:d})}else e.push(f(c))});d.addButton("btnthemifyMenu",{type:"menubutton",text:"",image:themifyEditor.editor.icon,tooltip:themifyEditor.editor.menuTooltip,menu:e})});
