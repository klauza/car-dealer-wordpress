var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(e,A,t){e instanceof String&&(e=String(e));for(var x=e.length,b=0;b<x;b++){var E=e[b];if(A.call(t,E,b,e))return{i:b,v:E}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,A,t){e!=Array.prototype&&e!=Object.prototype&&(e[A]=t.value)};$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(e,A,t,x){if(A){t=$jscomp.global;e=e.split(".");for(x=0;x<e.length-1;x++){var b=e[x];b in t||(t[b]={});t=t[b]}e=e[e.length-1];x=t[e];A=A(x);A!=x&&null!=A&&$jscomp.defineProperty(t,e,{configurable:!0,writable:!0,value:A})}};$jscomp.polyfill("Array.prototype.find",function(e){return e?e:function(e,t){return $jscomp.findInternal(this,e,t).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(e){var A=0;return $jscomp.iteratorPrototype(function(){return A<e.length?{done:!1,value:e[A++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};$jscomp.iteratorFromArray=function(e,A){$jscomp.initSymbolIterator();e instanceof String&&(e+="");var t=0,x={next:function(){if(t<e.length){var b=t++;return{value:A(b,e[b]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};
$jscomp.polyfill("Array.prototype.keys",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3");$jscomp.polyfill("Object.is",function(e){return e?e:function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.includes",function(e){return e?e:function(e,t){var x=this;x instanceof String&&(x=String(x));for(var b=x.length,A=t||0;A<b;A++)if(x[A]==e||Object.is(x[A],e))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(e,A,t){if(null==e)throw new TypeError("The 'this' value for String.prototype."+t+" must not be null or undefined");if(A instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression");return e+""};$jscomp.polyfill("String.prototype.includes",function(e){return e?e:function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}},"es6-impl","es3");
window.themifybuilderapp=window.themifybuilderapp||{};
(function(e){function A(){function a(a){var b="";if("string"===typeof a)b=a;else for(var c in a)b+=a[c];document.body.insertAdjacentHTML("beforeend",b)}var b=function(){if(themifyBuilder.debug)return!1;try{var a=localStorage.getItem("tb_form_templates"),b="";if(!a)return!1;var a=JSON.parse(a),c;for(c in themifyBuilder.modules)b+=c;return a.ver.toString()!==tbLocalScript.version.toString()||a.h!==Themify.hash(b)?!1:a.val}catch(h){}return!1}();b?a(b):e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_load_form_templates",
tb_load_nonce:themifyBuilder.tb_load_nonce},success:function(b){if(b){a(b);b=b.replace(/\s\s+/g," ");try{var c="",d;for(d in themifyBuilder.modules)c+=d;var e={val:b,ver:tbLocalScript.version,h:Themify.hash(c)};localStorage.setItem("tb_form_templates",JSON.stringify(e))}catch(k){}}}})}"function"===typeof window.top.document.ondragstart&&(window.top.document.ondragstart=null,window.document.ondragstart=null);var t=e.ui.sortable.prototype._mouseStart,x=document.body.classList.contains("full-section-scrolling");
e.ui.sortable.prototype._mouseStart=function(a,b,d){"mousedown"===a.type&&this._trigger("beforeStart",a,[this,this._uiHash()]);t.apply(this,[a,b,d])};void 0===e.fn.themifySerializeObject&&(e.fn.themifySerializeObject=function(){for(var a={},b=0,d=this.length;b<d;++b){var f=this[b].type;if(this[b].classList.contains("wp-editor-area")&&void 0!==tinyMCE){var g=tinyMCE.get(this[b].id);g&&(this[b].value=g.getContent())}if(""!==this[b].value&&this[b].name&&("text"===f||"number"===f||"radio"===f||"checkbox"===
f||"textarea"===f||"select-one"===f||"hidden"===f||"email"===f||"select"===f||"select-multiple"===f)){var g=this[b].name,e=this[b].value;"select-multiple"===f&&(e=jQuery(this[b]).val());if("radio"===f||"checkbox"===f)e=this[b].checked&&e;void 0!==a[g]&&"radio"!==f?(!a[g].push&&(a[g]=[a[g]]),e&&a[g].push(e)):e&&(a[g]=e)}}return a});var b=themifybuilderapp={activeModel:null,Models:{},Collections:{},Mixins:{},Views:{Modules:{},Rows:{},SubRows:{},Columns:{},Controls:{}},Forms:{},Utils:{},Instances:{Builder:{}},
cache:{repeaterElements:{}}},E=[];b.mode="default";b.autoSaveCid=null;b.hasChanged=null;b.editing=!1;b.init=!1;b.scrollTo=!1;b.eventName=!1;b.beforeEvent=!1;b.saving=!1;b.activeBreakPoint="desktop";b.zoomMeta={isActive:!1,size:100};b.isPreview=!1;b.Models.Module=Backbone.Model.extend({defaults:{element_id:null,elType:"module",mod_name:"",mod_settings:{}},initialize:function(){b.Models.Registry.register(this.cid,this);this.get("element_id")||this.set({element_id:b.Utils.generateUniqueID()},{silent:!0})},
toRenderData:function(){return{slug:this.get("mod_name"),name:themifyBuilder.modules[this.get("mod_name")].name,excerpt:this.getExcerpt()}},getExcerpt:function(a){a=a||this.get("mod_settings");return this.limitString(a.content_text||a.content_box||a.plain_text||"",100)},limitString:function(a,b){var c="";""!==a&&(a=this.stripHtml(a).toString(),c=a.length>b?a.substr(0,b):a);return c},stripHtml:function(a){var b=document.createElement("div");b.innerHTML=a;return b.textContent||b.innerText||""},setData:function(a){a=
b.Views.init_module(a);a.model.trigger("custom:change",a)},backendLivePreview:function(){e(".tb_element_cid_"+this.cid).find(".module_excerpt").text(this.getExcerpt())},getPreviewSettings:function(){return _.extend({cid:this.cid},themifyBuilder.modules[this.get("mod_name")].defaults,E)},getIDattr:function(){return this.get("element_id")?this.get("element_id"):b.Utils.generateUniqueID()}});b.Models.SubRow=Backbone.Model.extend({defaults:{element_id:null,elType:"subrow",row_order:0,gutter:"gutter-default",
column_alignment:"col_align_top",background_video:"",mutevideo:"",unloopvideo:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);this.get("element_id")||this.set({element_id:b.Utils.generateUniqueID()},{silent:!0})},setData:function(a){a=b.Views.init_subrow(a);a.model.trigger("custom:change",a)}});b.Models.Column=Backbone.Model.extend({defaults:{element_id:null,
elType:"column",column_order:"",grid_class:"",component_name:"column",background_video:"",mutevideo:"",unloopvideo:"",modules:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);this.get("element_id")||this.set({element_id:b.Utils.generateUniqueID()},{silent:!0})},setData:function(a){a=b.Views.init_column(a);a.model.trigger("custom:change",a)}});b.Models.Row=Backbone.Model.extend({defaults:{element_id:null,elType:"row",row_order:0,gutter:"gutter-default",column_alignment:x?
"col_align_middle":"col_align_top",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",background_video:"",mutevideo:"",unloopvideo:"",cols:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);this.get("element_id")||this.set({element_id:b.Utils.generateUniqueID()},{silent:!0})},setData:function(a){a=b.Views.init_row(a);a.model.trigger("custom:change",a)}});b.Collections.Rows=Backbone.Collection.extend({model:b.Models.Row});
b.Models.Registry={items:{},register:function(a,b){this.items[a]=b},lookup:function(a){return this.items[a]||null},remove:function(a){this.items[a]=null;delete this.items[a]},destroy:function(){_.each(this.items,function(a,b){a.destroy()});this.items={}}};b.Models.setValue=function(a,c,d){d=d||!1;b.Models.Registry.lookup(a).set(c,{silent:d})};b.vent=_.extend({},Backbone.Events);b.Views.register_module=function(a){"default"!==b.mode&&(this.Modules[b.mode]=this.Modules["default"].extend(a))};b.Views.init_module=
function(a){if(void 0===themifyBuilder.modules[a.mod_name])return!1;void 0===a.mod_settings&&void 0!==themifyBuilder.modules[a.mod_name].defaults&&(a.mod_settings=_.extend({},themifyBuilder.modules[a.mod_name].defaults));a=a instanceof b.Models.Module?a:new b.Models.Module(a);var c=new (this.get_module())({model:a,type:b.mode});return{model:a,view:c}};b.Views.get_module=function(){return this.Modules[b.mode]};b.Views.unregister_module=function(){"default"!==b.mode&&(this.Modules[b.mode]=null,delete this.Modules[b.mode])};
b.Views.module_exists=function(){return this.Modules.hasOwnProperty(b.mode)};b.Views.register_column=function(a){"default"!==b.mode&&(this.Columns[b.mode]=this.Columns["default"].extend(a))};b.Views.init_column=function(a){a=a instanceof b.Models.Column?a:new b.Models.Column(a);var c=new (this.get_column())({model:a,type:b.mode});return{model:a,view:c}};b.Views.get_column=function(){return this.Columns[b.mode]};b.Views.unregister_column=function(){"default"!==b.mode&&(this.Columns[b.mode]=null,delete this.Columns[b.mode])};
b.Views.column_exists=function(){return this.Columns.hasOwnProperty(b.mode)};b.Views.register_subrow=function(a){"default"!==b.mode&&(this.SubRows[b.mode]=this.SubRows["default"].extend(a))};b.Views.init_subrow=function(a){a=a instanceof b.Models.SubRow?a:new b.Models.SubRow(a);var c=new (this.get_subrow())({model:a,type:b.mode});return{model:a,view:c}};b.Views.get_subrow=function(){return this.SubRows[b.mode]};b.Views.unregister_subrow=function(){"default"!==b.mode&&(this.SubRows[b.mode]=null,delete this.SubRows[b.mode])};
b.Views.subrow_exists=function(){return this.SubRows.hasOwnProperty(b.mode)};b.Views.register_row=function(a){"default"!==b.mode&&(this.Rows[b.mode]=this.Rows["default"].extend(a))};b.Views.init_row=function(a){var c=a.attributes;return void 0===c||void 0!==c.cols&&(0<Object.keys(c.cols)||0<c.cols.length)||void 0!==c.styling&&0<Object.keys(c.styling).length?(a=a instanceof b.Models.Row?a:new b.Models.Row(a),c=new (this.get_row())({model:a,type:b.mode}),{model:a,view:c}):!1};b.Views.get_row=function(){return this.Rows[b.mode]};
b.Views.unregister_row=function(){"default"!==b.mode&&(this.Rows[b.mode]=null,delete this.Rows[b.mode])};b.Views.row_exists=function(){return this.Rows.hasOwnProperty(b.mode)};b.Views.BaseElement=Backbone.View.extend({type:"default",events:{"click .tb_copy_component":"copy","click .tb_paste_component":"paste","click .tb_copy_style":"copyStyling","click .tb_paste_style":"pasteStyling","click .tb_import_component":"import","click .tb_export_component":"export","click .tb_save_component":"save","click .tb_duplicate":"duplicate",
"click .tb_delete":"delete"},initialize:function(a){_.extend(this,_.pick(a,"type"));this.listenTo(this.model,"custom:change",this.modelChange);this.listenTo(this.model,"destroy",this.remove)},modelChange:function(){this.$el.attr(_.extend({},_.result(this,"attributes")));var a=this.render(),c=b.beforeEvent.data("cid");e(".tb_element_cid_"+c).replaceWith(a.el);"visual"===b.mode?this.model.trigger("visual:change"):("row"===b.eventName&&(c=this.$el.data("cid")),b.undoManager.push(c,b.beforeEvent,this.$el,
b.eventName),b.Mixins.Builder.update(this.$el),"row"===b.eventName&&b.vent.trigger("dom:builder:change"))},remove:function(){this.$el.remove()},copy:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("[data-cid]");var c=b.Models.Registry.lookup(a.data("cid"));if(c){var d=c.get("elType");"column"===d&&(d=c.get("component_name"));c=null;c=this.getData(a,d);"sub-column"===d&&(c.component_name=d);ThemifyBuilderCommon.Clipboard.set(d,c);var f=a.find(".tb_action_more > ul");
f.css("top","10000%");setTimeout(function(){f.css("top","100%")},100)}},paste:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("[data-cid]");var c=b.Models.Registry.lookup(a.data("cid"));if(c){var d=c.get("elType");"column"===d&&(d=c.get("component_name"));var f=ThemifyBuilderCommon.Clipboard.get(d),f=!1===f&&"column"===d?ThemifyBuilderCommon.Clipboard.get("sub-column"):f,f=!1===f&&"sub-column"===d?ThemifyBuilderCommon.Clipboard.get("column"):f;if(!1===f)ThemifyBuilderCommon.alertWrongPaste();
else if(ThemifyBuilderCommon.confirmDataPaste()){b.eventName="row";if("column"===d||"sub-column"===d){f.grid_class=b.Utils.filterClass(a.prop("class"));a.hasClass("first")?f.grid_class+=" first":a.hasClass("last")&&(f.grid_class+=" last");var g=a[0].style.width;f.grid_width=g?g.replace("%",""):null;f.component_name=d}b.beforeEvent=ThemifyBuilderCommon.clone(a);b.hasChanged=!0;c.setData(f)}}},copyStyling:function(a){a.preventDefault();a.stopPropagation();var c=e(a.currentTarget).closest("[data-cid]"),
d=b.Models.Registry.lookup(c.data("cid"));if(d){var f={};var g=d.get("elType");if("module"!==g)"column"===g&&(g=d.get("component_name")),f=d.attributes.styling;else{var h=function(a,b,c){Object.keys(b).forEach(function(d){if("breakpoint_mobile"===d||"breakpoint_tablet"===d||"breakpoint_tablet_landscape"===d)c[d]={},c[d]=h(a,b[d],c[d]);else{var f=d,g=d.indexOf("-");-1!==g&&(f=d.substring(0,g));var g=-1!==f.indexOf("padding")?!0:!1,e=-1!==f.indexOf("margin")?!0:!1,k=-1!==f.indexOf("border")?!0:!1;if(a.includes(f)||
g||e||k)c[d]=b[d]}});return c};g=a=d.get("mod_name");f=h(themifyBuilder.modules[a].styling,d.attributes.mod_settings,f)}d=null;ThemifyBuilderCommon.Clipboard.set(g+"Styling",f);var k=c.find(".tb_action_more > ul");k.css("top","10000%");setTimeout(function(){k.css("top","100%")},100)}},pasteStyling:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("[data-cid]");var c=b.Models.Registry.lookup(a.data("cid"));if(c){var d=c.get("elType"),d="column"===d?d=c.get("component_name"):
d,f="module"===d?c.get("mod_name"):d,g=ThemifyBuilderCommon.Clipboard.get(f+"Styling"),g=!1===g&&"column"===d?ThemifyBuilderCommon.Clipboard.get("sub-columnStyling"):g,g=!1===g&&"sub-column"===d?ThemifyBuilderCommon.Clipboard.get("columnStyling"):g;if(!1===g)ThemifyBuilderCommon.alertWrongPaste();else if(ThemifyBuilderCommon.confirmDataPaste()){f=this.getData(a,d);if("module"===d){var h=f.mod_settings;Object.keys(g).forEach(function(a){"breakpoint_mobile"===a||"breakpoint_tablet"===a||"breakpoint_tablet_landscape"===
a?(h[a]=void 0!==h[a]?h[a]:{},Object.keys(g[a]).forEach(function(b){h[a][b]=g[a][b]})):h[a]=g[a]});f.mod_settings=h}else f.styling=g;b.eventName="row";if("column"===d||"sub-column"===d){f.grid_class=b.Utils.filterClass(a.prop("class"));a.hasClass("first")?f.grid_class+=" first":a.hasClass("last")&&(f.grid_class+=" last");var k=a[0].style.width;f.grid_width=k?k.replace("%",""):null;f.component_name=d}b.beforeEvent=ThemifyBuilderCommon.clone(a);b.hasChanged=!0;c.setData(f)}}},"import":function(a){a.preventDefault();
a.stopPropagation();a=e(a.currentTarget);var c=ThemifyBuilderCommon.detectBuilderComponent(a),d=a.closest("[data-cid]"),f=b.Models.Registry.lookup(d.data("cid")),g={data:{action:"tb_component_data",component:c,type:"import"}};if("column"===c||"sub-column"===c){var h=a.closest(".module_column");var k=h.closest("column"===c?".module_row":".module_subrow").index();g.data.indexData={row:k,col:h.index()}}ThemifyBuilderCommon.Lightbox.open(g,null,function(){var a=this.$lightbox;a.find("#builder_submit_import_component_form").on("click",
function(g){g.preventDefault();g=a.find("#tb_data_field");g=JSON.parse(g.val());if("column"===c&&"sub-column"===g.component_name||"sub-column"===c&&"column"===g.component_name)g.component_name=c;if(void 0===g.component_name||g.component_name!==c)ThemifyBuilderCommon.alertWrongPaste();else{g=b.Utils.clear(g,!0);if("column"===c||"sub-column"===c)g.column_order=h.index(),g.grid_class=h.prop("class"),"column"===c?g.row_order=k:(g.sub_row_order=k,g.row_order=h.closest(".module_row").index(),g.col_order=
h.parents(".module_column").index());b.eventName="row";b.beforeEvent=ThemifyBuilderCommon.clone(d);b.hasChanged=!0;f.setData(g);ThemifyBuilderCommon.Lightbox.close()}})})},getData:function(a,c){var d={};var f=c||ThemifyBuilderCommon.detectBuilderComponent(a);switch(f){case "row":case "subrow":var g=a.closest(".module_"+f);var e=g.index();d=b.Utils._getRowSettings(g[0],e,f);break;case "module":d=b.Models.Registry.lookup(a.closest(".active_module").data("cid")).attributes;d=b.Utils.clear(d,!0);break;
case "column":case "sub-column":d=a.closest(".module_column"),g=d.closest("column"===f?".module_row":".module_subrow"),e=g.index(),f=b.Utils._getRowSettings(g[0],e,"column"===f?"row":"subrow"),d=f.cols[d.index()]}return d},"export":function(a){a.preventDefault();a.stopPropagation();var b=e(a.currentTarget);a=ThemifyBuilderCommon.detectBuilderComponent(b);var d=this.getData(b,a),b={data:{action:"tb_component_data",component:a,type:"export"}};d.component_name=a;d=JSON.stringify(d);ThemifyBuilderCommon.Lightbox.open(b,
null,function(){this.$lightbox.find("#tb_data_field").val(d).on("click",function(){e(this).trigger("focus").trigger("select")})})},duplicate:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("[data-cid]");var c=ThemifyBuilderCommon.clone(a),d=b.Models.Registry.lookup(c.data("cid"));a.removeClass("tb_element_cid_"+d.cid);c.hide().insertAfter(a);var f="module"===d.get("elType")?"mod_settings":"styling",g=this.getData(c,d.get("elType"));if(b.activeModel&&b.activeModel.cid===
d.cid&&ThemifyBuilderCommon.Lightbox.$lightbox.is(":visible")){var h=b.Forms.serialize("tb_options_setting"),k=b.Forms.serialize("tb_options_animation"),l=b.Forms.serialize("tb_options_visibility"),m=e.extend(!0,{},b.Mixins.Common.styleData),m=b.Forms.serialize("tb_options_styling",m),m=b.Utils.clear(m,!0),h=e.extend(!0,m,h,k,l),h=b.Utils.clear(h);g[f]=h}b.eventName="duplicate";b.beforeEvent=c;b.hasChanged=!0;d.setData(g);a.addClass("tb_element_cid_"+d.cid)},editComponent:function(){b.hasChanged=
!1;var a=b.activeModel.get("elType"),c=ThemifyBuilderCommon.Lightbox.$lightbox;if(b.autoSaveCid===b.activeModel.cid)b.activeModel.get("styleClicked")?(c.find('a[href="#tb_options_styling"]').trigger("click"),b.activeModel.unset("styleClicked",{silent:!0})):b.activeModel.get("visibileClicked")?(c.find('a[href="#tb_options_visibility"]').trigger("click"),b.activeModel.unset("visibileClicked",{silent:!0})):"module"!==a&&"row"!==a||c.find('a[href="#tb_options_setting"]').trigger("click");else{var d="module"===
a?b.activeModel.get("mod_name"):a;ThemifyBuilderCommon.Lightbox.open({loadMethod:"inline",templateID:"builder_form_"+d},function(c){b.Mixins.Common.editComponentCallback(c,a,!1,!1)},function(d){b.activeModel.get("styleClicked")?c.find('a[href="#tb_options_styling"]').trigger("click"):b.activeModel.get("visibileClicked")?c.find('a[href="#tb_options_visibility"]').trigger("click"):new SimpleBar(c.find("#"+("column"===a||"subrow"===a?"tb_options_styling":"tb_options_setting"))[0]);b.autoSaveCid=b.activeModel.cid;
setTimeout(function(){b.activeModel.unset("styleClicked",{silent:!0});b.activeModel.unset("visibileClicked",{silent:!0})},500)})}},"delete":function(a){var c;a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("[data-cid]");var d=a.data("cid"),f=b.Models.Registry.lookup(d);if(f){var g=f.get("elType");if(confirm(themifyBuilder.i18n[g+"DeleteConfirm"])){var h=a.closest(".module_row"),k="row",l="",m={};"row"===g?(m.pos_cid=h.next(".module_row"),m.pos="before",0===m.pos_cid.length&&(m.pos=
"after",m.pos_cid=h.prev(".module_row")),k="delete_row",m.pos_cid=m.pos_cid.data("cid")):d=h.data("cid");h=ThemifyBuilderCommon.clone(h);"row"!==g&&(c=a.closest(".module_subrow"));f.destroy();"row"!==g&&0<c.length&&0===c.find(".active_module").length&&c.addClass("tb_row_empty");"row"!==g?(l=e(".tb_element_cid_"+d),c=l.closest(".module_row"),0===c.find(".active_module").length&&c.addClass("tb_row_empty")):b.vent.trigger("dom:builder:change");b.hasChanged=!0;b.undoManager.push(d,h,l,k,m);b.toolbar.pageBreakModule.countModules()}}},
save:function(a){a.preventDefault();a.stopPropagation();a={data:{action:"tb_library_item_form",postid:themifyBuilder.post_ID,model:this.model.cid,type:ThemifyBuilderCommon.detectBuilderComponent(e(a.currentTarget))}};ThemifyBuilderCommon.Lightbox.open(a)}});b.Views.BaseElement.extend=function(a){var b=this,d=Backbone.View.extend.apply(this,arguments);d.prototype.events=_.extend({},this.prototype.events,a.events);d.prototype.initialize=function(){_.isFunction(b.prototype.initialize)&&b.prototype.initialize.apply(this,
arguments);_.isFunction(a.initialize)&&a.initialize.apply(this,arguments)};return d};b.Views.Modules["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){return{"class":"tb_module module-"+this.model.get("mod_name")+" active_module tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id"),"data-cid":this.model.cid}},template:"visual"===b.mode?null:wp.template("builder_module_item"),events:{dblclick:"edit","click .themify_module_options":"edit","click .tb_module_styling":"edit",
"click .tb_visibility_component ":"edit","click .tb_swap":"edit"},initialize:function(){this.listenTo(this,"edit",this.edit);this.listenTo(this.model,"dom:module:unsaved",this.removeUnsaved);this.listenTo(this.model,"change:view",this.setView)},removeUnsaved:function(){this.model.destroy()},render:function(){"visual"!==b.mode&&(this.el.innerHTML=this.template(this.model.toRenderData()));return this},setView:function(a){this.setElement(a)},edit:function(a){if(b.isPreview)return!0;if(null!==a){a.preventDefault();
a.stopPropagation();var c=a.currentTarget.classList;if("visual"===b.mode&&!b.Forms.LayoutPart.id&&"layout-part"===this.model.get("mod_name")&&!c.contains("tb_swap")&&("dblclick"===a.type||c.contains("themify_module_options"))){b.Forms.LayoutPart.edit(a.currentTarget);return}c.contains("tb_module_styling")?this.model.set({styleClicked:!0},{silent:!0}):c.contains("tb_visibility_component")&&this.model.set({visibileClicked:!0},{silent:!0})}this.model.cid!==b.autoSaveCid&&null!==b.autoSaveCid&&b.Forms.saveComponent(null);
b.activeModel=this.model;this.editComponent()}});b.Views.Columns["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){var a="column"===this.model.get("component_name")?"":" sub_column",a={"class":"module_column tb-column tb_element_cid_"+this.model.cid+" "+this.model.get("grid_class")+a,"data-cid":this.model.cid,"data-id":this.model.get("element_id")};this.model.get("grid_width")&&(a.style="width:"+this.model.get("grid_width")+"%");return a},template:wp.template("builder_column_item"),
events:{"click .tb_option_column":"edit",dblclick:"edit"},initialize:function(){this.listenTo(this.model,"change:view",this.setView)},render:function(a,c){var d=this.model.get("component_name");this.el.innerHTML=this.template({component_name:d});var f=this.model.get("modules");if(f){var g=document.createDocumentFragment(),e;for(e in f)if(void 0!==f[e]&&null!==f[e]){var k=f[e],l=void 0===k.cols?b.Views.init_module(k):b.Views.init_subrow(k);if(l){var m=void 0===k.cols&&c?c+"-"+e:a?a+"-"+e:!1;b.id&&
k.mod_name&&!1!==m&&(b.VisualCache[l.model.cid]=k.mod_name+"-"+b.id+"-"+m);g.appendChild(l.view.render(m).el)}}f=this.el.getElementsByClassName("tb_holder")[0];f.appendChild(g);"sub-column"===d&&f.classList.add("tb_subrow_holder")}return this},edit:function(a){a.preventDefault();a.stopPropagation();this.model.cid!==b.autoSaveCid&&null!==b.autoSaveCid&&b.Forms.saveComponent(null);b.activeModel=this.model;this.editComponent()},setView:function(a){this.setElement(a)}});b.Views.SubRows["default"]=b.Views.BaseElement.extend({tagName:"div",
attributes:function(){return{"class":"themify_builder_sub_row module_subrow active_module clearfix tb_element_cid_"+this.model.cid,"data-cid":this.model.cid,"data-id":this.model.get("element_id")}},events:{dblclick:"edit","click .tb_style_subrow":"edit","click .tb_visibility_subrow":"edit","mousedown select":"openSelectBox"},initialize:function(){this.listenTo(this.model,"change:view",this.setView)},openSelectBox:function(a){a.stopPropagation()},render:function(a){var c=this.model.get("cols"),d=Object.keys(c).length;
this.el.innerHTML=ThemifyBuilderCommon.templateCache.get("tmpl-builder_subrow_item");b.id&&(b.VisualCache[this.model.cid]="sub_row_"+a);if(0<d){for(var f=document.createDocumentFragment(),g=!1,e=0;e<=d;++e)if(void 0!==c[e]){c[e].component_name="sub-column";var k=a+"-"+e,l=b.Views.init_column(c[e]);b.id&&(b.VisualCache[l.model.cid]="sub_column_post_"+b.id+" sub_column_"+k);f.appendChild(l.view.render("sub_row_"+k).el);!1===g&&void 0!==c[e].modules&&0<c[e].modules.length&&(g=!0)}!1===g&&this.el.classList.add("tb_row_empty");
this.el.getElementsByClassName("subrow_inner")[0].appendChild(f)}b.init&&!b.id&&b.Utils.selectedGridMenu(this.el);return this},setView:function(a){this.setElement(a)},edit:function(a){a.stopPropagation();a.preventDefault();a.currentTarget.classList.contains("tb_style_subrow")?this.model.set({styleClicked:!0},{silent:!0}):a.currentTarget.classList.contains("tb_visibility_subrow")&&this.model.set({visibileClicked:!0},{silent:!0});this.model.cid!==b.autoSaveCid&&null!==b.autoSaveCid&&b.Forms.saveComponent(null);
b.activeModel=this.model;this.editComponent()}});b.Views.Rows["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){var a=this.model.attributes.styling&&"custom_css_row"in this.model.attributes.styling&&-1!==this.model.attributes.styling.custom_css_row.indexOf("tb-page-break")?"tb-page-break":"";return{"class":"themify_builder_row module_row clearfix tb_element_cid_"+this.model.cid+" "+a,"data-cid":this.model.cid}},events:{"click .tb_option_row":"edit",dblclick:"edit","click .tb_style_row":"edit",
"click .tb_visibility_component ":"edit","click .tb_grid_list li a":"_gridClicked","click .grid_tabs li a":"_switchGridTabs","click .tb_column_alignment li a":"_columnAlignmentClicked","click .tb_column_direction li a":"_columnDirectionClicked","change .gutter_select":"_gutterChange","dblclick .tb_options_row_hover":"_stopLightbox","hover .tb_option_row":"_updatePreviewOptions","click .tb_row_hover__expand":"_expandOptions","blur .tb_options_row_hover .tb_row_hover__input":"_setPreviewOption","click .tb_row_hover__icon":"_setPreviewOption"},
initialize:function(){this.listenTo(this.model,"change:view",this.setView)},render:function(a,c){var d=this.model.get("cols"),f=Object.keys(d).length;this.el.innerHTML=ThemifyBuilderCommon.templateCache.get("tmpl-builder_row_item");if(0<f){for(var g=document.createDocumentFragment(),e,k=!1,l=!1,m=!1,n=0;n<=f;++n)if(void 0!==d[n]){d[n].component_name="column";var p=b.Views.init_column(d[n]);b.id&&(e=p.model.get("column_order"),void 0===e&&(e=n),k=a+"-"+e,l=c+"-"+e);b.id&&(b.VisualCache[p.model.cid]=
"module_column_"+e+" tb_"+b.id+"_column");g.appendChild(p.view.render(k,l).el);!1===m&&void 0!==d[n].modules&&0<d[n].modules.length&&(m=!0)}!1===m&&this.el.classList.add("tb_row_empty");this.el.getElementsByClassName("row_inner")[0].appendChild(g)}else this.el.classList.add("tb_row_empty"),b.Utils._addNewColumn({newclass:"col-full",component:"column"},this.el.getElementsByClassName("row_inner")[0]);b.Utils.selectedGridMenu(this.el);return this},edit:function(a){a.stopPropagation();a.preventDefault();
b.activeModel&&b.activeModel.cid===this.model.get("cid")||(a.currentTarget.classList.contains("tb_style_row")?this.model.set({styleClicked:!0},{silent:!0}):a.currentTarget.classList.contains("tb_visibility_component")&&this.model.set({visibileClicked:!0},{silent:!0}),this.model.cid!==b.autoSaveCid&&null!==b.autoSaveCid&&b.Forms.saveComponent(null),b.activeModel=this.model,this.editComponent())},_switchGridTabs:function(a){b.scrollTo=e(a.currentTarget).closest("[data-cid]");b.Forms.lightbox_switcher(a)},
_gridClicked:function(a){a.preventDefault();a=e(a.currentTarget);var c=a.data("grid"),d=a.data("handle"),f=!1,g=a.data("type"),h=a.parent(),k="desktop"===g;if(!h.hasClass("selected")){var l=ThemifyBuilderCommon.clone(a.closest(".module_row"));h.addClass("selected").siblings().removeClass("selected");if("module"===d){if("-full"!==c[0]){f=!0;var m=b.Views.init_subrow({cols:[{grid_class:"col-full"}]});var h=a.closest(".active_module"),n=h.clone();n.insertAfter(h);var p=m.view.render().$el.find(".tb_holder").prepend(h).end().insertAfter(n).find("."+
a.prop("class").replace(" ",".")).closest("li").addClass("selected").siblings().removeClass("selected").end().end().end().find(".subrow_inner");n.remove();m=p.closest(".module_subrow")}}else f="subrow"===d,m=a.closest(".module_"+d),p=m.find("."+d+"_inner").first();if(0!==p.length){if(k||"module"===d){g=p;var u=a.data("col");g=g.add(m);void 0===u&&(u=1,a.data("col",u));g.removeClass("col-count-1 col-count-"+p.attr("data-basecol")).addClass("col-count-"+u);p.attr("data-basecol",u);k&&a.closest(".tb_grid_menu").find(".tb_grid_reposnive .tb_grid_list").each(function(){var a=
e(this).find(".selected"),b=a.find("a"),c=b.data("type"),b=b.data("col");void 0!==b&&(b>u||4===u&&3===b||4<=u&&4<=b&&u!=b)&&(a.removeClass("selected"),p.removeClass("tb_grid_classes col-count-"+p.attr("data-basecol")+" "+p.attr("data-col_"+c)).attr("data-col_"+c,""),e(this).closest(".tb_grid_list").find("."+c+"-auto").parent().addClass("selected"))})}else return"-auto"!==c[0]?(l="column"+c.join("-"),u=a.data("col"),3===u&&p.attr("data-basecol")>u&&(l+=" tb_3col"),p.removeClass(p.attr("data-col_tablet")+
" "+p.attr("data-col_tablet_landscape")+" "+p.attr("data-col_mobile")).addClass(l+" tb_grid_classes col-count-"+p.attr("data-basecol")).attr("data-col_"+g,l)):p.removeClass("tb_grid_classes tb_3col col-count-"+p.attr("data-basecol")+" "+p.attr("data-col_"+g)).attr("data-col_"+g,""),"visual"===b.mode&&e("body",top_iframe).height(document.body.scrollHeight),b.Utils.setCompactMode(p.children(".module_column")),!1;g=p.children(".module_column");k=c.length;d="module_column"+(f?" sub_column":"")+" col";
for(m=0;m<k;++m)h=g.eq(m),0<h.length?h.removeClass(b.Utils.gridClass.join(" ")).addClass(d+c[m]):b.Utils._addNewColumn({newclass:d+c[m],component:f?"sub-column":"column"},p[0]);k<p.children().length&&p.children(".module_column").eq(k-1).nextAll().each(function(){e(this).find(".tb_holder").first().children().appendTo(e(this).prev().find(".tb_holder").first());e(this).remove()});g=p.children();g.removeClass("first last");p.hasClass("direction-rtl")?(g.last().addClass("first"),g.first().addClass("last")):
(g.first().addClass("first"),g.last().addClass("last"));f&&"-full"===c[0]&&(c=p.closest(".module_subrow"),f=p.find(".active_module"),f.insertAfter(c),c.remove(),f.find(".tb_grid_list .grid-layout--full").parent().addClass("selected").siblings().removeClass("selected"));b.Utils.columnDrag(p,!0);m=a.closest(".module_row");b.hasChanged=!0;b.Mixins.Builder.updateModuleSort(m);b.undoManager.push(m.data("cid"),l,m,"row");Themify.body.trigger("tb_grid_changed",[m])}}},_columnAlignmentClicked:function(a){a.preventDefault();
a=e(a.currentTarget);var c=a.data("handle");if("module"!==c&&!a.closest("li").hasClass("selected")){a.closest("li").addClass("selected").siblings("li").removeClass("selected");var d=a.closest(".module_"+c);var f=a.data("alignment"),g=b.Models.Registry.lookup(d.data("cid")),h=ThemifyBuilderCommon.clone(d);d.find("."+c+"_inner").first().removeClass(g.get("column_alignment")).addClass(f);g.set({column_alignment:f},{silent:!0});b.undoManager.push(h.data("cid"),h,a.closest(".module_"+c),"row")}},_columnDirectionClicked:function(a){a.preventDefault();
var c=e(a.currentTarget),d=c.data("handle");a=c.data("dir");if("module"!==d&&!c.closest("li").hasClass("selected")){c.closest("li").addClass("selected").siblings("li").removeClass("selected");var c=c.closest(".module_"+d),d=c.find("."+d+"_inner").first(),f=d.children(".module_column"),c=f.first(),f=f.last();"rtl"===a?(c.removeClass("first").addClass("last"),f.removeClass("last").addClass("first"),d.addClass("direction-rtl")):(c.removeClass("last").addClass("first"),f.removeClass("first").addClass("last"),
d.removeClass("direction-rtl"));d.attr("data-"+b.activeBreakPoint+"_dir",a)}},_gutterChange:function(a){a=e(a.currentTarget);var c=a.data("handle");if("module"!==c){var d=a.val();a.find("option").removeAttr("selected").filter('[value="'+d+'"]').attr("selected","selected");var f=a.closest(".module_"+c),g=ThemifyBuilderCommon.clone(f),h=f.find("."+c+"_inner").first(),k=b.Models.Registry.lookup(f.data("cid"));g.find(".tb_action_wrap .gutter_select").val(f.data("gutter"));b.Utils.columnDrag(h,!1,k.get("gutter"),
d);h.removeClass(k.get("gutter")).addClass(d);k.set({gutter:d},{silent:!0});b.undoManager.push(g.data("cid"),g,a.closest(".module_"+c),"row")}},setView:function(a){this.setElement(a)},_stopLightbox:function(a){a.stopPropagation()},_updatePreviewOptions:function(){var a=e(".tb_options_row_hover .tb_row_hover__input"),c=b.Models.Registry.lookup(this.$el.data("cid")).get("styling");a.each(function(){var a=e(this),b=a.data("option"),b=c[b]||"";a.hasClass("tb_row_hover__icon")?(a.find(".selected").removeClass("selected"),
a.find('[data-value="'+b+'"]').addClass("selected")):a.val(b)})},_expandOptions:function(a){a.preventDefault();a=e(a.currentTarget).parent().parent().find(".tb_option_row");a.length&&a.trigger("click")},_setPreviewOption:function(a){var c=e(a.currentTarget),d=c.hasClass("tb_row_hover__icon")?"":c.val(),f=c.data("option"),g=this.model,h=g.get("styling"),k={};"click"===a.type&&(a=e(a.target),c.find(".selected").removeClass("selected"),a.addClass("selected"),d=a.data("value")||"");f&&h&&(k[f]=d,g.set({styling:e.extend({},
h,k)},{silent:!0}),"row_anchor"===f?this.$el.find(".tb_row_anchor").text(d.replace("#","")):c.hasClass("tb_row_hover__icon")&&"visual"===b.mode&&(b.activeModel=g,b.liveStylingInstance.init(g.get("styling")),Themify.body.trigger("tb_row_"+f.replace("row_",""),d)))}});b.Views.Builder=Backbone.View.extend({type:"default",events:{"click .tb_import_layout_button":"importLayoutButton"},initialize:function(a){_.extend(this,_.pick(a,"type"));b.vent.on("dom:builder:change",this.newRowAvailable.bind(this));
b.vent.on("dom:builder:init",this.init.bind(this))},init:function(a){b.init=a;this.rowSort();"visual"===b.mode?(b.Mixins.Builder.updateModuleSort(this.$el),a&&(this.initModuleVisualDrag(".tb_module"),this.initRowGridVisualDrag()),setTimeout(function(){b.Utils._onResize(!0)},1500)):(b.Mixins.Builder.updateModuleSort(this.$el),a&&(b.Mixins.Builder.initModuleDraggable(b.toolbar.$el,".tb_module"),b.Mixins.Builder.initModuleDraggable(b.toolbar.$el,".tb_row_grid")));var c=this;setTimeout(function(){b.Utils.setCompactMode(c.el.getElementsByClassName("module_column"))},
1E3);b.vent.trigger("dom:builder:change");setTimeout(c.insertLayoutButton.bind(c),200);b.init=!0},render:function(){for(var a=document.createDocumentFragment(),c=this.collection,d=!1,f=0,g=c.length;f<g;++f){var e=b.Views.init_row(c.models[f]);!1!==e&&(b.id&&(d=e.model.get("row_order"),void 0===d&&(d=f)),b.id&&(b.VisualCache[e.model.cid]="themify_builder_"+b.id+"_row module_row_"+d),a.appendChild(e.view.render(d,f).el))}this.el.appendChild(a);b.Utils.columnDrag(!1,!1);return this},newRowAvailable:function(){var a=
this.$el.children(".module_row:last");if(0===a.length||0<a.find(".active_module").length)a=b.Views.init_row({cols:[{grid_class:"col-full"}]}).view.render().$el,this.el.appendChild(a[0]),b.Mixins.Builder.updateModuleSort(a),"visual"===b.mode&&"desktop"!==b.activeBreakPoint&&e("body",top_iframe).height(document.body.scrollHeight)},insertLayoutButton:function(){this.$el.find(".tb_import_layout_button").remove();2>this.$(".module_row").length&&this.el.insertAdjacentHTML("beforeend",'<a href="#" class="tb_import_layout_button'+
(themifyBuilder.is_premium?"":" tb_lite")+'">'+themifyBuilder.i18n.text_import_layout_button+"</a>")},importLayoutButton:function(a){a.preventDefault();b.Views.Toolbar.prototype.loadLayout(a)}});b.Mixins.Common={styleData:{},doTheBinding:function(a,c,d){var f=!1,g=a.data("binding"),h="desktop"!==b.activeBreakPoint;c||void 0===g.empty?c&&void 0!==g[c]?f="radio"===a.attr("type")?a.is(":checked")?g[c]:!1:g[c]:c&&void 0!==g.not_empty?f=g.not_empty:void 0!==g.select&&c!==g.select.value?f=g.select:void 0!==
g.checked&&a.is(":checked")?f=g.checked:void 0===g.not_checked||a.is(":checked")||(f=g.not_checked):f=g.empty;void 0!==g.responsive&&a.is("select")&&(c=g.responsive,h&&void 0!==c.disabled&&void 0!==this.styleData.breakpoint_desktop[a.prop("id")]&&_.contains(c.disabled,this.styleData.breakpoint_desktop[a.prop("id")])&&(f=g[this.styleData.breakpoint_desktop[a.prop("id")]]));if(f){g=[];void 0!==f.show&&(g=f.show);void 0!==f.hide&&(g=g.concat(f.hide));if(void 0===d||0===d.length)d=e("#tb_lightbox_container",
top_iframe);a=0;for(g=g.length;a<g;++a)void 0!==f.hide&&void 0!==f.hide[a]&&e("."+f.hide[a],d).addClass("_tb_hide").hide(),void 0!==f.show&&void 0!==f.show[a]&&e("."+f.show[a],d).removeClass("_tb_hide").show();if(void 0!==f.responsive)for(g=[],void 0!==f.responsive.disabled&&(g=g.concat(f.responsive.disabled)),a=0,g=g.length;a<g;++a)void 0!==f.responsive.disabled&&void 0!==f.responsive.disabled[a]&&(h?e("."+f.responsive.disabled[a],d).addClass("reponive_disable"):e("."+f.responsive.disabled[a],d).removeClass("reponive_disable"))}},
moduleOptionsBinding:function(){var a=this;e(top_iframe).on("change","#tb_lightbox_container [data-binding]",function(){a.doTheBinding(e(this),e.trim(e(this).val()),e(this).closest(".tb_repeatable_field_content"))}).on("click",".themify-layout-icon[data-binding] a",function(){a.doTheBinding(e(this).parent(),e(this).prop("id"),e(this).closest(".tb_repeatable_field_content"))})},mode_change:function(a){function c(a){null===h&&(h=ThemifyBuilderCommon.Lightbox.$lightbox.find("#tb_options_styling")[0]);
g.styleData["breakpoint_"+a]=b.Forms.serialize("tb_options_styling",g.styleData,a,!1)}function d(b,d,f){c(d);g.editComponentCallback(h,a,g.styleData,!0)}var f="module"===a&&void 0!==b.activeModel.get("is_new")?e(".tb_element_cid_"+b.activeModel.cid).closest(".module_row"):e(".tb_element_cid_"+b.activeModel.cid);b.beforeEvent=ThemifyBuilderCommon.clone(f);var g=this,h=null;g.styleData={};g.styleData.breakpoint_desktop=e.extend(!0,{},b.activeModel.get("module"===a?"mod_settings":"styling"));for(var k in themifyBuilder.breakpoints)void 0!==
g.styleData.breakpoint_desktop["breakpoint_"+k]&&(g.styleData["breakpoint_"+k]=g.styleData.breakpoint_desktop["breakpoint_"+k],g.styleData.breakpoint_desktop["breakpoint_"+k]=null);Themify.body.off("themify_builder_change_mode",d).on("themify_builder_change_mode",d).one("themify_builder_lightbox_before_close",function(){E=[];b.saving&&c(b.activeBreakPoint);Themify.body.off("themify_builder_change_mode",d)})},editComponentCallback:function(a,c,d,f){function g(a){b.hasChanged=!0;a=0;for(var c=F.length;a<
c;++a)F[a].removeEventListener("change",g);F=null}function h(a){a=e(this).val();""!=a?ThemifyBuilderCommon.isImageUrl(a)?e(this).removeClass("tb_image_field_error"):(e(this).addClass("tb_image_field_error"),alert(themifyBuilder.i18n.incorrectImageURL)):e(this).removeClass("tb_image_field_error")}var k="styling",l=b.Mixins.Common,m=c,n=[],p=[],u=[],y=[],B=[],r=[],q=[],v=!1,t="desktop"!==b.activeBreakPoint?Object.keys(themifyBuilder.breakpoints).reverse():!1;"module"===c&&(m=b.activeModel.get("mod_name"),
k="mod_settings",v=void 0!==b.activeModel.get("is_new"));if(!1!==t){for(var x=t.indexOf(b.activeBreakPoint),w=0;w<=x;++w)t.shift();t.push("desktop")}var A=function(a,c,d,g){var h="";g?h=a.getAttribute("data-input-id"):(h=a.getAttribute("name"))||(h=a.getAttribute("id"));var k=c&&void 0!==c[h]?c[h]:!1;if(f||("px"!==k||a.classList.contains("tb_frame_unit"))&&"pixels"!==k&&"n"!==k&&"|"!==k&&"default"!==k&&"solid"!==k||a.classList.contains("themify-layout-icon")){var z=e(a),C=a.classList;if(!v&&!1!==
t&&!g&&!k)if(C.contains("themify-checkbox"))void 0!==d[h]&&0===z.closest("#tb_options_styling").length&&(k=d[h]);else{g=0;for(var w=t.length;g<w;++g)if(void 0!==d["breakpoint_"+t[g]]&&void 0!==d["breakpoint_"+t[g]][h]){k=d["breakpoint_"+t[g]][h];break}else if("desktop"===t[g]&&void 0!==d[h]){k=d[h];break}}if(C.contains("themify-gradient"))y.push({k:z,v:k}),k&&z.val(k);else if(C.contains("tb_range"))k&&z.val(k),B.push(z);else if(C.contains("tb_uploader_input"))k?(d=e("<img/>",{src:k,width:50,height:50}),
z.val(k).parent().find(".img-placeholder").html(d)):f&&z.val("").parent().find(".img-placeholder").empty();else if(C.contains("themify-option-query-cat"))k&&(d=z.parent(),g=k.split("|")[0],d.find("#"+h+"_dropdown").children("option[value='"+g+"']").prop("selected",!0),d.find(".query_category_multiple").val(g));else if(C.contains("tb_radio_input_container"))d=null,g=k?k:void 0!==z.data("default")?z.data("default"):!1,!1!==g&&""!==g?(d=z.find("input[value='"+g+"']"),d.is(":disabled")?d=null:d.prop("checked",
!0)):f&&C.contains("tb_icon_radio")&&z.find("input").prop("checked",!1),null===d&&(d=z.find("input:checked")),0<d.length&&C.contains("tb_option_radio_enable")&&p.push(d);else if(C.contains("themify-checkbox")){d=z.find(".tb-checkbox");!k&&_.isEmpty(c)&&(k=d.map(function(){return e(this).is(":checked")?e(this).val():null}).get().join("|"));if(k){var x=k.constructor===Array?k:k.split("|");d.each(function(){-1!==x.indexOf(e(this).val())&&e(this).prop("checked",!0)})}else if(!v||f)if(g=d.closest(".tb_input").find(".tb_seperate_items input"),
g.length){var D=!1;g.each(function(){if(e(this).val().length)return D=!0,!1});d.prop("checked",!D)}else d.prop("checked",!1);C.contains("tb_option_checkbox_enable")&&u.push(d)}else if(C.contains("themify-layout-icon"))if(k){d=a.getElementsByClassName("tfl-icon");g=0;for(h=d.length;g<h;++g)k===d[g].getAttribute("id")?d[g].classList.add("selected"):d[g].classList.remove("selected");d=null}else d=themifyBuilder.modules[m],void 0!==d&&void 0!==d.defaults&&d.defaults[h]?z.find("#"+d.defaults[h]).addClass("selected"):
z.find("a").first().addClass("selected");else if("SELECT"===a.tagName)if(f||!C.contains("unstick_el_row_select_input")&&!C.contains("unstick_el_module_select_input"))k?("maps-pro"===m&&"w_map_unit"===h?k=c.unit_w?c.unit_w:"px":C.contains("font-family-select")?z.data("selected",k):C.contains("font-weight-select")&&z.attr("data_value",k),z.val(k)):f&&z.find("option").prop("selected",!1),f&&C.contains("font-family-select")&&(-1===z.prop("tabindex")?z.trigger("change.select"):k&&(d=z.find("optgroup"),
void 0!==ThemifyBuilderCommon.safe_fonts[k]?d.first().html('<option selected="selected" data-type="webfont" value="'+k+'">'+ThemifyBuilderCommon.safe_fonts[k]+"</option>"):d.last().html('<option selected="selected" value="'+k+'">'+ThemifyBuilderCommon.google_fonts[k]+"</option>")));else{g=C.contains("unstick_el_module_select_input")?"module":"row";var F=[];d=b.activeModel.get("element_id");g=b.Utils.getUIDList(g);h=0;for(c=g.length;h<c;++h)g[h].element_id!==d&&(a="row"===g[h].elType?"Row #"+g[h].element_id:
g[h].mod_name+" #"+g[h].element_id,"row"===g[h].elType&&g[h].styling&&g[h].styling.custom_css_id?a="#"+g[h].styling.custom_css_id:"module"===g[h].elType&&g[h].mod_settings&&g[h].mod_settings.custom_css_id&&(a="#"+g[h].mod_settings.custom_css_id),F.push("<option "+(g[h].element_id===k?'selected="selected" ':"")+'value="'+g[h].element_id+'">'+a+"</option>"));g=null;setTimeout(function(){z[0].innerHTML=F.join("");F=null},1500)}else if("TEXTAREA"===a.tagName||"INPUT"===a.tagName){d="TEXTAREA"===a.tagName;
if(k||f)f&&!k&&(k=""),z.val(k),C.contains("minicolors-input")?(g=k,h="",-1!==k.indexOf("_")?(g=b.Utils.toRGBA(k),k=k.split("_"),(h=k[1])?0>=parseFloat(h)&&(h=0):h=1,z.val(k[0])):k&&(-1===k.indexOf("#")&&(g="#"+k),h=1),z.attr("data-opacity",h).next(".minicolors-swatch").find("span").css({background:g,opacity:h}).closest(".minicolors").next(".color_opacity").val(h)):d&&!v&&(C.contains("tb_shortcode_input")||C.contains("tb_thumbs_preview"))&&l.getShortcodePreview(z,k);d&&C.contains("tb_lb_wp_editor")&&
n.push(z)}else if(C.contains("tb_row_js_wrapper")){var w=k?k.length-1:0,G=e.Event("click",{isTrigger:!0,currentTarget:z.next(".add_new").find("a").first()});void 0===b.cache.repeaterElements[h]&&(c=a.getElementsByClassName("tb_repeatable_field"),b.cache.repeaterElements[h]=e(c[0]).clone());for(g=0;g<w;++g)b.Forms.moduleOptAddRow(G,null);c=a.getElementsByClassName("tb_repeatable_field");g=0;for(a=c.length;g<a;++g)for(var w=c[g].getElementsByClassName("tb_lb_option_child"),G=void 0!==k[g]?k[g]:!1,h=
0,E=w.length;h<E;++h)A(w[h],G,d,!0);r.push({el:z,binding_type:z.data("control-binding")})}z.data("binding")?q.push({el:z,v:k}):C.contains("themify-checkbox")&&z.find(".tb-checkbox").data("binding")&&q.push({el:z.find(".tb-checkbox"),v:k});f||!z.data("control-binding")||C.contains("tb_lb_wp_editor")||C.contains("minicolors-input")||C.contains("themify-gradient")||"repeater"===z.data("control-type")||b.Views.init_control(z.data("control-type"),{el:z,binding_type:z.data("control-binding"),selector:z.data("live-selector")})}};
d=f?d:b.activeModel.get(k);var D=e.extend(!0,{},d);if("desktop"!==b.activeBreakPoint||f)if(void 0!==D["breakpoint_"+b.activeBreakPoint])D=D["breakpoint_"+b.activeBreakPoint];else for(w=0,k=t.length;w<k;++w)if(void 0!==D["breakpoint_"+t[w]]){D=D["breakpoint_"+t[w]];break}e(a.querySelectorAll('.tb_uploader_input:not(#background_video):not([data-control-type="audio"])')).on("focus",function(a){if(void 0!==a.originalEvent)e(this).one("blur",h)}).on("change paste keyup",function(){e(this).removeClass("tb_image_field_error")});
for(var F=a.getElementsByClassName("tb_lb_option"),w=0,k=F.length;w<k;++w)A(F[w],D,d,!1),f||F[w].addEventListener("change",g,{once:!0});f&&(F=null);setTimeout(function(){for(var a=0,b=p.length;a<b;++a)ThemifyBuilderCommon.Lightbox.clickRadioOption(null,p[a]);p=null;a=0;for(b=u.length;a<b;++a)ThemifyBuilderCommon.Lightbox.clickCheckboxOption(null,u[a]);u=null},1);f||(0<r.length&&setTimeout(function(){for(var a=0,c=r.length;a<c;++a)b.Views.init_control("repeater",r[a]);r=null},200),setTimeout(function(){q=
q.reverse();for(var a=0,b=q.length;a<b;++a)l.doTheBinding(q[a].el,q[a].v);q=null},1),setTimeout(function(){for(var a=0,c=B.length;a<c;++a)b.Utils.createRange(B[a]);B=null},100));setTimeout(function(){l.applyAll_init(f);for(var b=a.getElementsByClassName("border_style"),c=0,d=b.length;c<d;++c)ThemifyBuilderCommon.Lightbox.hideShowBorder(null,e(b[c]))},10);void 0!==e.fn.ThemifyGradient&&setTimeout(function(){for(var a=0,c=y.length;a<c;++a)b.Utils.createGradientPicker(y[a].k,y[a].v,f);y=null},400);f||
(setTimeout(function(){ThemifyBuilderCommon.fontPreview(ThemifyBuilderCommon.Lightbox.$lightbox.find("#tb_lightbox_container"))},300),v&&"gallery"===m&&setTimeout(function(){e(".tb_gallery_btn",a).trigger("click")},1),setTimeout(function(){b.Utils.builderPlupload("normal")},120),setTimeout(function(){b.Utils.setColorPicker(a)},1),"module"!==c?setTimeout(function(){b.Utils.setImageSelect(a)},800):setTimeout(function(){b.Utils.datePicker(a)},100),"visual"===b.mode&&(setTimeout(function(){E="module"===
c?b.Forms.serialize("tb_options_setting"):D;b.liveStylingInstance.init(E)},1),v||ThemifyBuilderCommon.Lightbox.rememberRow()),setTimeout(function(){if(0<n.length){var a=function(){for(var a=0,c=n.length;a<c;++a)b.Views.init_control("wp_editor",{el:n[a],binding_type:n[a].data("control-binding"),selector:n[a].data("live-selector")});n=null};if(b.activeModel.get("styleClicked")||b.activeModel.get("visibileClicked"))Themify.body.on("themify_builder_tabsactive",function H(b,c,d){"#tb_options_setting"===
c&&(a(),Themify.body.off("themify_builder_tabsactive",H))});else a()}l.mode_change(c)},1),Themify.body.trigger("editing_"+c+"_option",[m,D,a]),"visual"===b.mode&&window.top.jQuery("body").trigger("editing_"+c+"_option",[m,D,a]))},applyAll_init:function(a){var b=e(".style_apply_all",top_iframe);b.off("change.tb_apply_all").on("change.tb_apply_all",function(a){var b;e(this).parent().css("display","inline-block");var c=e(this).closest(".tb_input").find(".tb_seperate_items"),d=c.find("li");a=!a.isTrigger;
var k=e(this).hasClass("tb_has_radio_options")?!0:!1;k&&(b=e(this).siblings("input:radio"));e(this).is(":checked")?(k&&b.addClass("_tb_disable"),d.not(":first-child").hide(),d.first().find("span.tb_tooltip_up").hide(),d.first().find("span.tb_range_after").hide(),c.attr("data-checked",1)):(k&&b.removeClass("_tb_disable"),d.show(),d.first().find("span.tb_range_after").show(),d.first().find("span.tb_tooltip_up").show(),c.removeAttr("data-checked"),k&&d.first().find("select").trigger("change"));a&&d.first().find("select").trigger("change")});
b.each(function(){e(this).parent().css("display","inline-block");if(e(this).hasClass("tb_has_radio_options")){var a=this;e(this).siblings("input:radio").on("click",function(b){e(a).trigger("change.tb_apply_all")})}});a||(b=b.filter(":checked"));b.trigger("change.tb_apply_all")},getShortcodePreview:function(a,b){function c(b){a.next(".tb_shortcode_preview").remove();b&&a.after(b)}var f=this;void 0===f.galerry_cache&&(f.galerry_cache={});void 0!==f.galerry_cache[b]?c(f.galerry_cache[b]):e.ajax({type:"POST",
url:themifyBuilder.ajaxurl,data:{action:"tb_load_shortcode_preview",tb_load_nonce:themifyBuilder.tb_load_nonce,shortcode:b},success:function(a){c(a);f.galerry_cache[b]=a}})}};b.Mixins.Builder={before:null,zindex:null,r:null,w:null,h:null,type:null,moduleHolderArgs:null,subrows:null,update:function(a){var c=null!==b.activeModel?b.activeModel.get("elType"):b.Models.Registry.lookup(a.data("cid")).get("elType");"visual"===b.mode&&b.Utils.loadContentJs(a,c);a=a.closest(".module_row");b.Utils.columnDrag(a.find(".row_inner"),
!1);b.Utils.columnDrag(a.find(".subrow_inner"),!1);b.Mixins.Builder.updateModuleSort(a)},dragScroll:function(a,c){function d(a){a=e(this).prop("id");a=("tb_toolbar"===a||"wpadminbar"===a?"-":"+")+("="+m+"px");g.stop().animate({scrollTop:a},800)}var f=e("body",top_iframe);"visual"===b.mode&&(f=f.add(Themify.body));void 0===this.top&&(this.top=b.toolbar.$el,this.top=this.top.add(e("#tb_fixed_bottom_scroll",top_iframe)),"visual"!==b.mode&&(this.top=this.top.add("#wpadminbar")));if(!0===c)this.top.off("mouseenter"),
"row"===a&&"visual"===b.mode&&b.toolbar.$el.find('.tb_zoom[data-zoom="100"]').trigger("click"),f.removeClass("tb_drag_start tb_drag_"+a);else{var g="desktop"===b.activeBreakPoint?e("body,html"):e("body,html",top_iframe),h=0;if("visual"===b.mode){var k=g.height();h=e(window.top).height()}else k=e("#page-builder").height();var l=k-h,m=(k-h)*(1E4<l?2:5E3<l?5:10)/100;f.addClass("tb_drag_start tb_drag_"+a);"row"===a&&"visual"===b.mode&&b.toolbar.$el.find('.tb_zoom[data-zoom="50"]').trigger("click");if(0<
m)this.top.off("mouseenter").on("mouseenter",d)}},rowSort:function(){var a=this,c,d={items:">.module_row",handle:".tb_row_actions>.tb_grid_icon",axis:"y",placeholder:"tb_state_highlight",containment:"parent",tolerance:"pointer",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!1,beforeStart:function(b,d,e){a.before||(c=!0,a.before=e.item.next(".module_row"),0===a.before.length&&(a.before=e.item.prev(".module_row"),c=!1),a.before=a.before.data("cid"),a.dragScroll("row"))},stop:function(b,d){a.before=
c=null;a.dragScroll("row",!0)},update:function(d,g){if("visual"===b.mode&&!g.item.hasClass("tb_row_grid")){var f="desktop"===b.activeBreakPoint?e("html,body"):e("body",top_iframe);f.scrollTop(g.item.offset().top);f=null}if("sortupdate"===d.type&&a.before){b.hasChanged=!0;var f=g.item.next(".module_row"),k=!0;0===f.length&&(f=g.item.prev(".module_row"),c=k=!1);f=f.data("cid");b.undoManager.push(g.item.data("cid"),null,null,"row_sort",{bnext:c,before:a.before,anext:k,after:f})}else g.item.hasClass("predesigned_row")||
g.item.hasClass("tb_page_break_module")||"row"===g.item.data("type")?"row"===g.item.data("type")?b.toolbar.libraryItems.get(g.item.data("id"),"row",function(b){Array.isArray(b)||(b=Array(b));a.rowDrop(b,g.item)}):g.item.hasClass("tb_page_break_module")?b.toolbar.pageBreakModule.get(function(b){a.rowDrop(b,g.item)}):b.toolbar.preDesignedRows.get(g.item.data("slug"),function(b){a.rowDrop(b,g.item)}):g.item.hasClass("tb_row_grid")&&a.subRowDrop(g.item.data("slug"),g.item);b.toolbar.pageBreakModule.countModules()}};
"visual"===b.mode&&(d.helper=function(){return e('<div class="tb_sortable_helper"/>')});this.$el.sortable(d)},columnSort:function(a){var c,d;a.find(".row_inner, .subrow_inner").sortable({items:"> .module_column",handle:"> .tb_column_action .tb_column_dragger",axis:"x",placeholder:"tb_state_highlight",tolerance:"pointer",cursorAt:{top:20,left:20},beforeStart:function(a,b,e){Themify.body.addClass("tb_drag_start");c=ThemifyBuilderCommon.clone(e.item.closest(".module_row"));d=e.item.siblings();d.css("marginLeft",
0)},start:function(a,b){e(".tb_state_highlight").width(b.item.width())},stop:function(a,b){Themify.body.removeClass("tb_drag_start");d.css("marginLeft","")},update:function(a,d){var f=d.item.closest(".ui-sortable"),g=f.children(".module_column");g.removeClass("first last");f.hasClass("direction-rtl")?(g.last().addClass("first"),g.first().addClass("last")):(g.first().addClass("first"),g.last().addClass("last"));b.Utils.columnDrag(f,!1);b.Utils.setCompactMode(g);f=f.closest(".module_row");b.undoManager.push(f.data("cid"),
c,f,"row")}})},updateModuleSort:function(a,c){var d=e(".tb_holder",a);if(c)return d.sortable(c),!1;d.each(function(){e(this).data({uiSortable:null,sortable:null})});var f=this,g=null,h,k;this.moduleHolderArgs={placeholder:"tb_state_highlight",items:".active_module,>div>.active_module",connectWith:".module_row:not(.tb-page-break) .tb_holder",revert:100,scroll:!1,cancel:".tb_disable_sorting",cursorAt:{top:10,left:90},sort:function(a,b){null===g&&(g=this.classList.contains("active_module")?this.children:
e(this).find(e(this).sortable("option").items).get(),k=e(this).children(".tb_state_highlight:first"),h=b.helper.outerHeight());for(var c=b.position.top,d=c+h,m=0,l=g.length;m<l;++m)if(!g[m].classList.contains("tb_sortable_helper")&&!g[m].classList.contains("tb_state_highlight")){var B=e(g[m]);var r=B.outerHeight();var q=B.position().top;var v=q+r;if(c>q&&c<v){if(r=Math.min(f.helpHeight,r)/2,v=c-q,v<r){k.insertBefore(B);e(this).sortable("refreshPositions");break}}else if(d<v&&d>q&&(r=Math.min(f.helpHeight,
r)/2,v-=d,v<r)){k.insertAfter(B);e(this).sortable("refreshPositions");break}}},beforeStart:function(a,b,c){if(!f.before&&(f.r=c.item.closest(".module_row"),0<f.r.length?(f.before=ThemifyBuilderCommon.clone(f.r),f.zindex=f.r.css("zIndex"),"auto"===f.zindex&&(f.zindex=""),f.r.css("zIndex",2)):f.r=null,f.w=c.item[0].style.width,f.h=c.item[0].style.height,c.item.css({width:180,height:30}),f.type="module",f.subrows=null,c.item[0].classList.contains("module_subrow")?(f.type+=" tb_drag_subrow",f.subrows=
!0):c.item[0].classList.contains("tb_row_grid")&&(f.type="column",f.subrows=!0),f.dragScroll(f.type),!0===f.subrows)){f.subrows=[];a=[];c=0;for(var d=b.items.length;c<d;++c)b.items[c].instance.element[0].classList.contains("tb_subrow_holder")?(f.subrows.push(b.items[c].instance.element),b.items[c].instance.destroy()):a.push(b.items[c]);b.items=a;a=[];c=0;for(d=b.containers.length;c<d;++c)b.containers[c].element[0].classList.contains("tb_subrow_holder")?(f.subrows.push(b.containers[c].element),b.containers[c].destroy()):
a.push(b.containers[c]);b.containers=a}},stop:function(a,c){"visual"===b.mode&&c.helper&&e(c.helper).remove();c.item.css({width:f.w,height:f.h});f.dragScroll(f.type,!0);f.r&&f.r.css("zIndex",f.zindex);f.before=f.w=f.h=g=k=f.r=f.zindex=h=f.type=null;if(f.subrows)for(var d=0,m=f.subrows.length;d<m;++d)f.subrows[d][0].classList.contains("ui-sortable")||f.subrows[d].sortable(f.moduleHolderArgs);f.subrows=null},update:function(a,c){c.item.css({width:f.w,height:f.h});if(c.item.hasClass("tb_module_dragging_helper")){E=
[];var g=e(c.item.clone(!1));if(c.item.data("id")){var h=c.item.closest(".module_row");0<h.length&&(f.before=ThemifyBuilderCommon.clone(h),f.before.find(".tb_module_dragging_helper").remove())}c.item.after(g);f.moduleDrop(g,null,f.before)}else{if(c.sender&&(g=c.sender.closest(".module_row"),c.sender.closest(".module_row").toggleClass("tb_row_empty",0===g.find(".active_module").length),g=c.sender.closest(".module_subrow"),0<g.length&&g.toggleClass("tb_row_empty",0===g.find(".active_module").length),
c.item.hasClass("module_subrow")&&0<c.item.parent().closest(".module_subrow").length)){d.sortable("cancel");return}f.before&&(b.hasChanged=!0,c.item.hasClass("module_subrow")||c.item.closest(".module_subrow").removeClass("tb_row_empty"),g=c.item.closest(".module_row"),g.removeClass("tb_row_empty"),b.undoManager.push(c.item.data("cid"),f.before,g,"sort",{before:f.before.data("cid"),after:g.data("cid")}),f.before=null,b.vent.trigger("dom:builder:change"),Themify.body.trigger("tb_"+f.type+"_sort",[c.item]))}}};
"visual"===b.mode&&(this.moduleHolderArgs.helper=function(){return e('<div class="tb_sortable_helper"/>')});d.sortable(this.moduleHolderArgs)},initModuleDraggable:function(a,c){var d=this,f=e.extend(!0,{},this.moduleHolderArgs);f.update=!1;f.appendTo=document.body;f.items=c;".tb_row_grid"===c&&(f.connectWith=[f.connectWith,"visual"===b.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper"]);f.stop=function(a,b){e(this).sortable("cancel");b.item.removeClass("tb_sortable_helper tb_module_dragging_helper");
d.moduleHolderArgs.stop(a,b)};f.start=function(a,b){b.item.addClass("tb_sortable_helper tb_module_dragging_helper")};f.helper=function(a,b){return e('<div class="tb_sortable_helper tb_module_dragging_helper">'+b.text()+"</div>")};a.sortable(f)},initRowDraggable:function(a,c){var d=this;a.find(c).draggable({appendTo:Themify.body,helper:"clone",revert:"invalid",connectToSortable:"visual"===b.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper",cursorAt:{top:10,left:40},start:function(a,
b){d.dragScroll("row");b.helper.addClass("tb_module_dragging_helper tb_sortable_helper").find(".tb_predesigned_rows_list_image").remove()},stop:function(a,b){d.dragScroll("row",!0)}})},initModuleVisualDrag:function(a){var c=this;b.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",dropitems:".tb_holder",elements:".active_module",type:"module",onDrop:function(a,b,g){c.moduleDrop(b,!1,ThemifyBuilderCommon.clone(g.closest(".module_row")))}})},initRowGridVisualDrag:function(){var a=this;b.toolbar.$el.find(".tb_row_grid").ThemifyDraggable({iframe:"#tb_iframe",
dropitems:".tb_holder:not('.tb_subrow_holder'),.themify_builder_content:not('.not_editable_builder')>.module_row",elements:".active_module",cancel:".tb_subrow_holder",append:!1,type:"column",onDrop:function(b,d,f){a.subRowDrop(d.data("slug"),d)}})},initRowVisualDrag:function(a){var c=this;b.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",dropitems:".themify_builder_content:not('.not_editable_builder')>.module_row",append:!1,type:"row",onDrop:function(a,f,g){f.addClass("tb_state_highlight").find(".tb_predesigned_rows_list_image").remove();
f.show();a="desktop"===b.activeBreakPoint?e("html,body"):e("body",top_iframe);a.scrollTop(f.offset().top-e("#headerwrap.fixed-header").outerHeight());a=null;"row"===f.data("type")?b.toolbar.libraryItems.get(f.data("id"),"row",function(a){Array.isArray(a)||(a=Array(a));c.rowDrop(a,f)}):f.hasClass("tb_page_break_module")?b.toolbar.pageBreakModule.get(function(a){c.rowDrop(a,f)}):b.toolbar.preDesignedRows.get(f.data("slug"),function(a){c.rowDrop(a,f)})}})},subRowDrop:function(a,c){var d=0<c.parent(".themify_builder_content,#tb_row_wrapper").length;
if(d||0===c.closest(".sub_column").length){a=b.Utils.grid(a);if(!d){var f=ThemifyBuilderCommon.clone(c.closest(".module_row"));f.find(".tb_row_grid").remove();var g="row"}var e=(d?b.Views.init_row({cols:a[0].cols}):b.Views.init_subrow({cols:a[0].cols})).view.render().$el;if(d||0<c.parent(".tb_holder").length)c[0].parentNode.replaceChild(e[0],c[0]);else{var k=c.next(".tb_holder");0<k.length?k.prepend(e):(k=c.prev(".tb_holder"),k.append(e))}if(d){f=e.next(".module_row");var l=!0;0===f.length&&(l=!1,
f=e.prev(".module_row"));f=f.data("cid");g="grid_sort"}e.find(".tb_grid_"+b.activeBreakPoint+' .tb_grid_list [data-col="'+a[0].cols.length+'"]').first().parent().addClass("selected");b.Utils.setCompactMode(e[0].getElementsByClassName("module_column"));b.Mixins.Builder.update(e);c.remove();b.hasChanged=!0;e=e.closest(".module_row");d||e.removeClass("tb_row_empty");e.find(".tb_row_grid").remove();b.undoManager.push(e.data("cid"),f,e,g,{next:l})}else c.remove()},rowDrop:function(a,c){function d(){var a=
c.prev(".module_row");if(0===a.length){var d="visual"===b.mode?c.closest(".themify_builder_content").data("postid"):null;a=!1}else a=a.data("cid");c[0].innerHTML="";c[0].parentNode.replaceChild(g,c[0]);b.hasChanged=!0;b.undoManager.push("","","","predesign",{prev:a,rows:e,bid:d});a=0;for(d=e.length;a<d;++a){var f=e[a].find(".module_column");e[a].find('ul.tb_grid_list li a[data-col="'+f.length+'"]').first().parent().addClass("selected");b.Utils.setCompactMode(f);b.Mixins.Builder.update(e[a])}ThemifyBuilderCommon.showLoader("hide")}
for(var f=function(a){for(var b in a)if(a[b].styling&&0<Object.keys(a[b].styling).length||a[b].modules&&0<Object.keys(a[b].modules).length)return!0;return!1},g=document.createDocumentFragment(),e=[],k=[],l=0,m=a.length;l<m;++l)if(a[l].styling&&0<Object.keys(a[l].styling).length||a[l].cols&&f(a[l].cols)){var n=b.Views.init_row(a[l]);if(!1!==n){n=n.view.render();g.appendChild(n.el);if("visual"===b.mode){var p=n.el.querySelectorAll("[data-cid]");k[n.el.dataset.cid]=1;l=0;for(m=p.length;l<m;++l)k[p[l].dataset.cid]=
1}e.push(n.$el)}}"visual"===b.mode?(b.bootstrap(k,d),k=null):d()},moduleDrop:function(a,c,d){function f(f){function g(f){k||l.model.set({is_new:1},{silent:!0});f=!0===f?l.model.getPreviewSettings():l.model.get("mod_settings");c?c.append(p.el):a.replaceWith(p.el);k?b.activeModel=l.model:l.view.trigger("edit",null);b.hasChanged=!0;if("visual"===b.mode&&1<Object.keys(f).length)if("part"===h||"ajax"===a.data("type")){var g=!0;l.model.trigger("custom:preview:refresh",f)}else"module"!==h&&l.model.trigger("custom:preview:live",
f);if(k){if(g){var m=l.view.$el.find(".tb_preview_component").detach();setTimeout(function(){l.view.$el.prepend(m)},50)}d&&(g=p.$el.closest(".module_row"),g.removeClass("tb_row_empty").find(".tb_module_dragging_helper").remove(),p.$el.closest(".module_subrow").removeClass("tb_row_empty"),b.undoManager.push(g.data("cid"),d,g,"row"),b.vent.trigger("dom:builder:change"),e(".tb_import_layout_button").remove())}}var l=b.Views.init_module(f),p=l.view.render();"visual"===b.mode&&k?(f=[],f[l.model.cid]=1,
b.bootstrap(f,g)):g(!0)}if(a[0].classList.contains("tb_row_grid"))this.subRowDrop(a.data("slug"),a);else{var g={mod_name:a.data("module-slug")},h=a.data("type"),k="part"===h||"module"===h;k?b.toolbar.libraryItems.get(a.data("id"),h,f):f(g);"visual"!==b.mode&&e(".themify-wp-editor-holder:not(.themify-active-holder)").length&&e(".themify-wp-editor-holder").addClass("themify-active-holder")}},toJSON:function(){for(var a={},c=this.el.getElementsByClassName("module_row"),d=0,f=0,g=c.length;f<g;++f){var e=
b.Utils._getRowSettings(c[f],f);0<Object.keys(e).length&&(a[d]=e,++d)}return a}};b.Forms={Data:{},Validators:{},bindEvents:function(){var a="true"===themifyBuilder.isTouch?"touchend":"click";e("body",top_iframe).on(a,".builder_save_button",this.saveComponent).on(a,"#tb_lightbox_parent .add_new a",this.moduleOptAddRow).on(a,"#tb_submit_import_form",this.builderImportSubmit).on(a,".tb_lightbox_switcher a",this.lightbox_switcher).on(a,".layout_preview img",this.templateSelected).on(a,"#builder_submit_layout_form",
this.saveAsLayout).on(a,"#builder_submit_library_item_form",this.saveAsLibraryItem).on("keypress","#tb_library_item_form input",this.saveAsLibraryItem).on("keyup","#row_anchor",this.rowAnchor);Themify.body.on("themify_builder_lightbox_close",this.clear).on(a,".tb_module_front a",this.disable_links);b.Mixins.Common.moduleOptionsBinding()},parseSettings:function(a,b,d,f){var c=!1,h=e(a),k=a.classList,l="",m=!0;f?l=h.data("input-id"):(l=a.getAttribute("name"))||(l=a.getAttribute("id"));if(k.contains("tb_lb_wp_editor"))void 0!==
tinyMCE?(c=a.getAttribute("id"),a=tinyMCE.get(c),c=null!==a?!1===a.hidden?a.getContent():switchEditors.wpautop(tinymce.DOM.get(c).value):h.val()):c=h.val();else if(k.contains("themify-checkbox")){var n=[];h.find(".tb-checkbox:checked").each(function(a){n.push(e(this).val())});c=0<n.length?n.join("|"):!1;n=null;m=!1}else if(k.contains("themify-layout-icon"))c=h.find(".selected").prop("id"),m=!k.contains("tb_frame");else if(k.contains("themify-option-query-cat"))a=h.parent(),c=a.find(".query_category_single"),
a=a.find(".query_category_multiple"),c=a.val()?a.val()+"|multiple":c.val()+"|single";else if(k.contains("tb_row_js_wrapper")){c=[];a=a.getElementsByClassName("tb_repeatable_field_content");f=0;for(var p=a.length;f<p;++f){var u=a[f].getElementsByClassName("tb_lb_option_child");c[f]={};for(var y=0,B=u.length;y<B;++y){var r=this.parseSettings(u[y],b,d,!0);r&&"px"!==r.v&&"n"!==r.v&&"pixels"!==r.v&&"solid"!==r.v&&"default"!==r.v&&"|"!==r.v&&(c[f][r.id]=r.v)}}}else k.contains("tb_radio_input_container")?
(m=h.find("input:checked"),"desktop"!==d&&m.hasClass("reponive_disable")||(c=m.val()),m=!1):k.contains("module-widget-form-container")?c=h.find(":input").themifySerializeObject():k.contains("tb_widget_select")?c=h.find(".selected").data("value"):(c=h.val(),""!==c?(m=h.attr("data-opacity"),void 0!==m&&""!==m&&1!=m&&"0.99"!=m&&(c+="_"+m),m=!k.contains("tb_frame")&&!k.contains("border_color")&&!k.contains("border_width")):c=!1);if(c||!b)if(!b||"px"!==c&&"pixels"!==c&&"n"!==c&&"solid"!==c&&"linear"!==
c&&"default"!==c&&"|"!==c&&("desktop"===d||0===h.closest(".reponive_disable").length)||"%"!==c&&k.contains("tb_frame_unit")){if(!b&&!1===c)c="";else if("%"===c&&k.contains("tb_frame_unit"))return!1;return{id:l,v:c,checked:m}}return!1},serialize:function(a,c,d){d=d||b.activeBreakPoint;var f=void 0!==c;void 0===this.breakpoints&&"desktop"!==d&&f&&(this.breakpoints=Object.keys(themifyBuilder.breakpoints).reverse());var g={};a=top_iframe.getElementById(a).getElementsByClassName("tb_lb_option");var e=
"desktop"!==d&&f&&void 0!==this.breakpoints?this.breakpoints:!1;if(!1!==e){for(var k=e.indexOf(d),l=0;l<=k;++l)e.shift();e.push("desktop")}l=0;for(k=a.length;l<k;++l){var m=this.parseSettings(a[l],f,d,!1);if(!1!==m){if(!1!==e&&!0===m.checked&&"SELECT"!==a[l].tagName){for(var n=!1,p=0,u=e.length;p<u;++p)if(void 0!==c["breakpoint_"+e[p]]&&void 0!==c["breakpoint_"+e[p]][m.id]&&c["breakpoint_"+e[p]][m.id]===m.v){n=!0;break}else if("desktop"===e[p]&&void 0!==c[m.id]&&c[m.id]===m.v){n=!0;break}if(n)continue}g[m.id]=
m.v}}return g},saveComponent:function(a){var c=null===a;c||a.preventDefault();if(b.hasChanged){var d=b.Forms,f=b.activeModel.get("elType");a="module"===f;if(!a||d.isValidate(e("#tb_module_settings",top_iframe))){Themify.body.trigger("themify_builder_save_component");"visual"===b.mode&&window.top.jQuery("body").trigger("themify_builder_save_component");b.saving=!0;var g={},h=null,k=!1,l=!1,m=null,n=null,p="styling",u=e(".tb_element_cid_"+b.activeModel.cid);if(a||"row"===f||"subrow"===f)a&&(p="mod_settings",
k=b.activeModel.get("is_new"),b.activeModel.unset("is_new",{silent:!0})),"subrow"!==f&&(n=d.serialize("tb_options_setting")),h=d.serialize("tb_options_animation");if(a||"row"===f||"subrow"===f)m=d.serialize("tb_options_visibility"),"visual"===b.mode&&("hide_all"===m.visibility_all||"hide"===m.visibility_desktop||"hide"===m.visibility_tablet||"hide"===m.visibility_mobile?u.addClass("tb_visibility_hidden"):u.removeClass("tb_visibility_hidden"));"visual"===b.mode&&b.liveStylingInstance.remember(b.activeModel.cid);
c?Themify.body.trigger("themify_builder_lightbox_before_close"):ThemifyBuilderCommon.Lightbox.close(c);d=e.extend(!0,{},b.Mixins.Common.styleData);f=d.breakpoint_desktop;d.breakpoint_desktop=null;for(var y in d)f[y]=d[y];g[p]=e.extend(!0,f,n,h,m);g[p]=b.Utils.clear(g[p]);y=b.activeModel.get(p);b.activeModel.set(g,{silent:!0});a&&(k&&(l=u.closest(".module_column"),l.closest(".module_row").removeClass("tb_row_empty"),l.closest(".module_subrow").removeClass("tb_row_empty"),l=ThemifyBuilderCommon.clone(l)),
b.vent.trigger("dom:builder:change"),e(".tb_import_layout_button").remove());if("visual"===b.mode){var B=b.liveStylingInstance.undoData;var r=e.extend(!0,{},b.liveStylingInstance.getRememberedStyles())}b.undoManager.push(b.activeModel.cid,b.beforeEvent,u,"save",{bsettings:y,asettings:g[p],bstyles:B,astyles:r,column:l});b.beforeEvent=!1;b.saving=!1;c&&ThemifyBuilderCommon.Lightbox.close(c)}}else ThemifyBuilderCommon.Lightbox.close(c)},moduleOptAddRow:function(a,c){function d(a){a=e(this).val();""!=
a?ThemifyBuilderCommon.isImageUrl(a)?e(this).removeClass("tb_image_field_error"):(e(this).addClass("tb_image_field_error"),alert(themifyBuilder.i18n.incorrectImageURL)):e(this).removeClass("tb_image_field_error")}a.preventDefault();var f=e(a.currentTarget).parent().prev(),g=b.cache.repeaterElements[f.prop("id")].clone(),h=Math.random().toString(36).substr(2,7),k=[],l=!1,m=!1,n=[],p=!a.isTrigger||c;g.removeClass("collapsed").find(".row_inner").show();var u=g[0].getElementsByClassName("tb_lb_option_child");
c=c?e(c):!1;for(var y=0,B=u.length;y<B;++y){var r=e(u[y]);var q=c?c.find('[data-input-id="'+r.data("input-id")+'"]'):!1;var v=u[y].classList;if(v.contains("tb_lb_wp_editor")){var t=r.data("input-id");var x=r.data("control-repeater");var w=r.closest(".wp-editor-wrap");r=t+"_"+y+"_"+Math.random().toString(36).substr(2,7);!1===l&&(l=w[0].innerHTML);w[0].innerHTML=l.replace(new RegExp(t,"g"),r);r=w.find(".tb_lb_wp_editor");r.attr({name:t,"data-input-id":t,"data-control-repeater":x}).data({"input-id":t,
"control-repeater":x});q?(q=q.prop("id"),q=(w=tinyMCE.get(q))&&!1===w.hidden?w.getContent():switchEditors.wpautop(tinymce.DOM.get(q).value),r.val(q)):r.val("");k.push(r)}else if(v.contains("themify-layout-icon"))w=r.find("a"),w.removeClass("selected"),q?w.filter("#"+q.find(".selected").prop("id")).addClass("selected"):(q=themifyBuilder.modules[b.activeModel.get("mod_name")],void 0!==q&&void 0!==q.defaults&&q.defaults[t]?w.filter("#"+q.defaults[t]).addClass("selected"):w.first().addClass("selected"));
else if(v.contains("tb_uploader_input"))p&&(m=!0,q=!1!==q?q.val():"",w=r.val(q).parent(),x=w.find(".thumb_preview").find(".img-placeholder"),w.find(".tb_upload_btn").prop("id","pluploader_"+h+"_"+y+"tb_plupload_upload_ui").addClass("plupload-clone").find(".builder_button").prop("id","pluploader_"+h+"_"+y+"tb_plupload_browse_button"),""!==q&&(q=e("<img/>",{src:q,width:50,height:50}),x.html(q)));else if(v.contains("tb_radio_input_container")){w=u[y].getElementsByClassName("tb_radio_dnd");x=r.data("input-id");
var A=q?q.find(":checked").val():!1;q=0;for(var D=w.length;q<D;++q){var F=e(w[q]);F.prop({name:x+"_"+h,id:x+"_"+h+"_"+q,checked:!1}).next("label").prop("for",x+"_"+h+"_"+q);(A===F.val()||!A&&F.data("checked"))&&F.prop("checked",!0)}v.contains("tb_option_radio_enable")&&ThemifyBuilderCommon.Lightbox.clickRadioOption(null,r.find(":checked"))}else A=q?q.val():"",void 0===A&&(A=""),r.val(A),p&&(v.contains("tb_range")?n.push(r):q&&v.contains("minicolors-input")&&(w=q.closest(".minicolors_wrapper"),x=w.find(".minicolors-swatch-color"),
D=r.closest(".minicolors_wrapper"),q=q.data("opacity"),D.find(".minicolors-swatch-color").css({"background-color":x.css("background-color"),opacity:q}),D.find(".color_opacity").val(w.find(".color_opacity").val()),r.data("opacity",q).attr("data-opacity",q),x=D=q=w=null));p&&(r.data("binding")&&b.Mixins.Common.doTheBinding(r,A,g),!r.data("control-binding")||v.contains("tb_lb_wp_editor")||v.contains("minicolors-input")||v.contains("themify-gradient")||b.Views.init_control(r.data("control-type"),{el:r,
binding_type:r.data("control-binding"),selector:r.data("live-selector")}))}e(g[0].querySelectorAll('.tb_uploader_input:not([data-control-type="audio"])')).on("focus",function(a){e(this).removeClass("tb_image_field_error");if(void 0!==a.originalEvent)e(this).one("blur",d)});p&&setTimeout(function(){b.Utils.setColorPicker(g)},1);f[0].appendChild(g[0]);p&&(0<k.length&&setTimeout(function(){for(var a=0,c=k.length;a<c;++a)b.Views.init_control("wp_editor",{el:k[a],binding_type:k[a].data("control-binding"),
selector:k[a].data("live-selector")});k=null},1),0<n.length&&setTimeout(function(){for(var a=0,c=n.length;a<c;++a)b.Utils.createRange(n[a]);n=null},200),m&&b.Utils.builderPlupload("new_elemn"))},builderImportSubmit:function(a){a.preventDefault();var c=e(this);ThemifyBuilderCommon.LiteLightbox.confirm(themifyBuilder.i18n.dialog_import_page_post,function(a){e.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"builder_import_submit",nonce:themifyBuilder.tb_load_nonce,data:c.closest("form").serialize(),
importType:"no"===a?"replace":"append",importTo:themifyBuilder.post_ID},beforeSend:function(a){ThemifyBuilderCommon.showLoader("show")},success:function(a){b.Forms.reLoad(a,themifyBuilder.post_ID);ThemifyBuilderCommon.Lightbox.close()}})},{buttons:{no:{label:"Replace Existing Builder"},yes:{label:"Append Existing Builder"}}})},lightbox_switcher:function(a){a.preventDefault();a=e(a.currentTarget).attr("href").replace("#","");a!==b.activeBreakPoint&&(b.activeModel&&"visual"===b.mode&&(b.scrollTo=b.liveStylingInstance.$liveStyledElmt),
e(".tb_breakpoint_switcher.breakpoint-"+a,top_iframe).trigger("click"))},disable_links:function(a){a.preventDefault()},rowAnchor:function(){if("visual"===b.mode){var a=b.liveStylingInstance;var c=a.getStylingVal("row_anchor");a.$liveStyledElmt.removeClass(a.getRowAnchorClass(c))}c=e.trim(e(this).val());"visual"===b.mode?(a.setStylingVal("row_anchor",c),""!==c&&a.$liveStyledElmt.addClass(a.getRowAnchorClass(c)),a=a.$liveStyledElmt,a.data("anchor",c).attr("data-anchor",c)):a=e(".tb_element_cid_"+b.activeModel.cid);
a.children(".tb_row_actions").find(".tb_row_anchor").text(c.replace("#",""))},LayoutPart:{cache:[],undo:null,old_id:null,isReload:null,id:null,init:!1,html:null,el:null,options:null,scrollTo:function(a,c){b.scrollTo=b.Forms.LayoutPart.el},insertSwap:function(a){a.getElementsByClassName("tb_dropdown")[0].insertAdjacentHTML("afterbegin",'<li><div class="tb_swap ti-reload themify-tooltip-bottom"><div class="themify_tooltip">Swap</div></div></li>')},edit:function(a){function c(a){document.getElementById("themify_builder_content-"+
themifyBuilder.post_ID).insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>');f.addClass("tb_active_layout_part").closest(".row_inner").find(".active_module").each(function(){this.classList.contains("tb_active_layout_part")||this.insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>')});var c="themify_builder_content-"+d.id;d.html=f[0].innerHTML;themifyBuilder.post_ID=d.id;f[0].insertAdjacentHTML("afterbegin",h.replace("#postID#",d.id));f.removeClass("active_module module").closest(".tb_holder").removeClass("tb_holder").addClass("tb_layout_part_parent").closest(".module_row").addClass("tb_active_layout_part_row");
g.attr("id",c).removeClass("not_editable_builder").empty();d.el=f;b.id=d.id;var k=[],n=e("."+c+".not_editable_builder").closest(".active_module");n.each(function(){e(this).find(".themify-builder-generated-css").prop("disabled",!0)});n=null;b.Instances.Builder[1]=new b.Views.Builder({el:"#"+c,collection:new b.Collections.Rows(a),type:b.mode});a=b.Instances.Builder[1].render().el.querySelectorAll("[data-cid]");c=0;for(n=a.length;c<n;++c)k[a[c].dataset.cid]=1;a=null;b.bootstrap(k,function(){k=null;b.Utils.loadContentJs(g);
b.id=!1;Themify.body.on("themify_builder_change_mode",d.scrollTo);b.hasChanged=!0;b.vent.trigger("dom:builder:init");f.find(".tb_toolbar_save").click(d.save.bind(d));f.find(".tb_toolbar_close_btn").click(d.close.bind(d));f.find(".tb_load_layout").click(b.Views.Toolbar.prototype.loadLayout);f.find(".tb_toolbar_import ul a").click(b.Views.Toolbar.prototype["import"]);ThemifyBuilderCommon.showLoader("hide");d.init=!1;d.undo=b.undoManager.stack;b.undoManager.btnUndo=f[0].getElementsByClassName("tb_undo_btn")[0];
b.undoManager.btnRedo=f[0].getElementsByClassName("tb_redo_btn")[0];b.undoManager.reset();f.find(".tb_undo_redo").click(function(a){b.undoManager.do_change(a)});"desktop"!==b.activeBreakPoint&&b.Mixins.Builder.updateModuleSort(null,"disable")})}ThemifyBuilderCommon.showLoader("show");document.body.classList.add("tb_layout_part_edit");b.activeModel&&e(".builder_save_button",top_iframe).trigger("click");top_iframe.body.classList.add("tb_layout_part_edit");var d=this,f=e(a).closest(".active_module"),
g=f.find(".themify_builder_content"),h=ThemifyBuilderCommon.templateCache.get("tmpl-small_toolbar");this.id=g.data("postid");this.old_id=themifyBuilder.post_ID;this.init=!0;void 0!==this.cache[this.id]?c(this.cache[this.id]):e.ajax({type:"POST",dataType:"json",url:themifyBuilder.ajaxurl,data:{action:"tb_layout_part_swap",nonce:themifyBuilder.tb_load_nonce,id:d.id},success:function(a){a&&(d.cache[d.id]=a,c(a))}})},close:function(a){function c(){d.el.removeClass("tb_active_layout_part").addClass("active_module module").closest(".tb_layout_part_parent").addClass("tb_holder").removeClass("tb_layout_part_parent").closest(".module_row").removeClass("tb_active_layout_part_row");
e("#tb_small_toolbar",d.el).remove();for(var a=f[0].querySelectorAll("[data-cid]"),c=0,g=a.length;c<g;++c){var m=a[c].dataset.cid,n=b.Models.Registry.lookup(m);n&&(n.destroy(),b.Models.Registry.remove(m),b.liveStylingInstance.revertRules(m),delete b.VisualCache[m])}f.removeAttr("id").addClass("not_editable_builder");document.body.classList.remove("tb_layout_part_edit");top_iframe.body.classList.remove("tb_layout_part_edit");e(".tb_overlay").remove();b.undoManager.stack=d.undo;b.undoManager.index=
d.undo.length-1;b.undoManager.btnUndo=b.toolbar.el.getElementsByClassName("tb_undo_btn")[0];b.undoManager.btnRedo=b.toolbar.el.getElementsByClassName("tb_redo_btn")[0];themifyBuilder.post_ID=d.old_id;d.old_id=null;d.html=null;d.id=null;d.el=null;d.options=null;d.isReload=null;b.Instances.Builder[1]=null;delete b.Instances.Builder[1];d.undo=null;Themify.body.off("themify_builder_change_mode",d.scrollTo);b.Mixins.Builder.updateModuleSort();b.undoManager.updateUndoBtns();"desktop"!==b.activeBreakPoint&&
b.Mixins.Builder.updateModuleSort(null,"disable")}a.preventDefault();a.stopPropagation();var d=this,f=this.el.find(".themify_builder_content");if(null!==this.options){ThemifyBuilderCommon.showLoader("show");a=b.Models.Registry.lookup(this.el.data("cid"));this.cache[this.id]=this.options;e(document).ajaxComplete(function k(a,g,n){if(-1!==n.data.indexOf("tb_load_module_partial",3))if(e(this).off("ajaxComplete",k),200===g.status){d.el=b.liveStylingInstance.$liveStyledElmt;f=d.el.children(".themify_builder_content");
var m=f[0].innerHTML,l="";d.el.children(".themify-builder-generated-css").each(function(){l+=this.outerHTML});e(".themify_builder_content-"+d.id).each(function(){if(e(this).hasClass("not_editable_builder")){var a=e(this).closest(".module");a.children("link.themify-builder-generated-css").remove();""!==l&&a[0].insertAdjacentHTML("afterbegin",l);this.innerHTML=m;b.Utils.loadContentJs(e(this))}});l=m=null;ThemifyBuilderCommon.showLoader("hide");c()}else ThemifyBuilderCommon.showLoader("error")});var g=
e.extend(!0,{},a.get("mod_settings"));g.unsetKey=!0;a.trigger("custom:preview:refresh",g);g=null}else a=e(".themify_builder_content-"+d.id+".not_editable_builder").closest(".active_module"),a.each(function(){e(this).find(".themify-builder-generated-css").removeAttr("disabled")}),a=null,this.el[0].innerHTML=d.html,c(),b.Utils.loadContentJs(f)},save:function(a){a.preventDefault();a.stopPropagation();if(b.undoManager.hasUndo()||null!==this.isReload){var c=this;this.old_settings=this.html=null;ThemifyBuilderCommon.showLoader("show");
b.activeModel&&e(".builder_save_button",top_iframe).trigger("click");b.Utils.saveBuilder(function(a){a.success&&(c.options=a.data.builder_data)},"main",1)}else ThemifyBuilderCommon.showLoader("show"),setTimeout(function(){ThemifyBuilderCommon.showLoader("hide")},100)}},reLoad:function(a,c,d){function f(){"visual"===b.mode&&(b.Utils.loadContentJs(e(l)),b.id=!1);b.vent.trigger("dom:builder:init");ThemifyBuilderCommon.showLoader("hide");"visual"===b.mode&&"desktop"!==b.activeBreakPoint&&(e("body",top_iframe).height(document.body.scrollHeight),
setTimeout(function(){e("body",top_iframe).height(document.body.scrollHeight)},2E3));d&&d()}var g=null!==b.Forms.LayoutPart.id,h=g?1:0,k=null,l="";b.Mixins.Builder.updateModuleSort(null,"destroy");g||(b.Models.Registry.destroy(),b.Instances.Builder={});if("visual"===b.mode){var m="themify-builder-"+c+"-generated-css",n=e("link#"+m),l="#themify_builder_content-"+c;b.id=c;if(g){var p=b.Instances.Builder[h].$el.closest(".module-layout-part");n=n.add(p.children(".themify-builder-generated-css"))}n.remove();
void 0!==a.css&&void 0!==a.css.css_file&&(m='<link id="'+m+'" type="text/css" rel="stylesheet" href="'+a.css.css_file+"?tmp="+Date.now()+'" />',a.css.fonts&&(m+='<link id="themify-builder-'+c+'-font" type="text/css" rel="stylesheet" href="//fonts.googleapis.com/css?family='+a.css.fonts.join("|")+'" />'),g?(p[0].insertAdjacentHTML("afterbegin",m),p.children("link").removeAttr("id").addClass("themify-builder-generated-css"),p=null):document.getElementById("themify-builder-admin-ui-css").insertAdjacentHTML("afterend",
m),m=null);g||(b.VisualCache=[],b.editing=!1,setTimeout(function(){b.liveStylingInstance.reset()},1),Themify.body.addClass("sidebar-none full_width"),e("#sidebar,.page-title").remove())}else l="#tb_row_wrapper";if(g){c=b.Instances.Builder[h].el.querySelectorAll("[data-cid]");b.Forms.LayoutPart.isReload=!0;p=0;for(m=c.length;p<m;++p){var n=c[p].dataset.cid,u=b.Models.Registry.lookup(n);u&&(u.destroy(),b.Models.Registry.remove(n),b.liveStylingInstance.revertRules(n))}c=null;b.Instances.Builder[h].$el.empty()}b.Instances.Builder[h]=
new b.Views.Builder({el:l,collection:new b.Collections.Rows(a.builder_data),type:b.mode});b.Instances.Builder[h].render();b.undoManager.reset();if(g){k=[];c=b.Instances.Builder[h].el.querySelectorAll("[data-cid]");p=0;for(m=c.length;p<m;++p)k[c[p].dataset.cid]=1;c=null}"visual"===b.mode?b.bootstrap(k,f):f()},templateSelected:function(a){a.preventDefault();a.stopPropagation();var c=e(this).closest(".layout_preview");ThemifyBuilderCommon.LiteLightbox.confirm(themifyBuilder.i18n.confirm_template_selected,
function(a){var d=themifyBuilder.post_ID,g={type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_set_layout",mode:"no"===a?1:0,nonce:themifyBuilder.tb_load_nonce,layout_slug:c.data("slug"),id:d,layout_group:c.data("group")},beforeSend:function(){"visual"===b.mode&&ThemifyBuilderCommon.showLoader("show")},success:function(a){ThemifyBuilderCommon.Lightbox.close();"success"===a.status?b.Forms.reLoad(a,d):(ThemifyBuilderCommon.showLoader("error"),alert(a.msg))}};if("pre-designed"===
c.data("group")){ThemifyBuilderCommon.showLoader("show");var h=c.data("slug"),k="https://themify.me/themify-layouts/"+h+".txt",l=function(){g.data.builder_data=b.layouts_selected[h];e.ajax(g)};if(!b.layouts_selected)b.layouts_selected={};else if(b.layouts_selected[h]){l();return}e.get(k,null,null,"text").done(function(a){b.layouts_selected[h]=a;l()}).fail(function(a,b,c){ThemifyBuilderCommon.LiteLightbox.alert("There was an error in loading layout, please try again later, or you can download this file: ("+
k+") and then import manually (https://themify.me/docs/builder#import-export).")}).always(function(){ThemifyBuilderCommon.showLoader()})}else e.ajax(g)},{buttons:{no:{label:"Replace Existing Layout"},yes:{label:"Append Existing Layout"}}})},saveAsLayout:function(a){a.preventDefault();e.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_custom_layout",nonce:themifyBuilder.tb_load_nonce,form_data:e("#tb_save_layout_form",top_iframe).serialize()},success:function(a){"success"===
a.status?ThemifyBuilderCommon.Lightbox.close():alert(a.msg)}})},saveAsLibraryItem:function(a){if("keypress"!==a.type||13===a.keyCode){a.preventDefault();ThemifyBuilderCommon.showLoader("show");a=ThemifyBuilderCommon.Lightbox.$lightbox.find("#tb_library_item_form");var c=a.find('[name="model"]').val(),d=b.Models.Registry.lookup(c),f=d.get("elType");switch(f){case "row":var g=b.Utils._getRowSettings(e(".tb_element_cid_"+c)[0],0);break;case "module":g={mod_name:d.get("mod_name"),mod_settings:d.get("mod_settings")}}a.find('[name="item"]').val(JSON.stringify(g));
a.find('[name="nonce"]').val(themifyBuilder.tb_load_nonce);e.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:a.serialize(),success:function(a){if("success"===a.status){e("#tb_module_panel",top_iframe).find(".tb_module_panel_search_text").val("");if(a.is_layout){b.hasChanged=!0;var d=b.Views.ControlRegistry.lookup("selected_layout_part");d&&(d.data=[]);var d=e(".tb_element_cid_"+c),g=ThemifyBuilderCommon.clone(d);if("row"===f){var h=b.Views.init_row(a.replWith);var n=h.view.render();
h=b.Models.Registry.lookup(n.$el.find(".active_module").data("cid"))}else h=b.Views.init_module(a.replWith),n=h.view.render(),h=h.model;d.replaceWith(n.el);if("visual"===b.mode)e(document).ajaxComplete(function r(a,c,d){-1!==d.data.indexOf("tb_load_module_partial",3)&&(e(this).off("ajaxComplete",r),p="row"===f?b.liveStylingInstance.$liveStyledElmt.closest(".module_row"):b.liveStylingInstance.$liveStyledElmt,b.undoManager.push(n.$el.data("cid"),g,p,"row"))}),h.trigger("custom:preview:refresh",h.get("mod_settings"));
else{var p=n.el;b.Mixins.Builder.updateModuleSort(n.$el);b.undoManager.push(n.$el.data("cid"),g,p,"row")}}d=e(".tb_library_item_list");a=b.toolbar.libraryItems.template([a]);"visual"===b.mode&&(d=d.add(b.toolbar.$el.find(".tb_library_item_list")));d=d.get();h=0;for(var u=d.length;h<u;++h){var y=d[h].getElementsByClassName("simplebar-content");0<y.length&&(y[0].insertAdjacentHTML("afterbegin",a),e(d[h]).closest(".tb_module_panel_tab").find(".tb_module_types .active a").trigger("click"))}b.toolbar.libraryItems.bindEvents(!0);
ThemifyBuilderCommon.showLoader("hide");ThemifyBuilderCommon.Lightbox.close()}else alert(a.msg)}})}},isValidate:function(a){var b=a.find("[data-validation]");if(0===b.length)return!0;var d=this,f={};b.each(function(){var a=e(this),b=a.data("validation"),c=a.val();d.checkValidate(b,c)||(f[a.prop("id")]=a.data("error-msg"))});a.find(".tb_field_error").removeClass("tb_field_error").end().find(".tb_field_error_msg").remove();if(_.isEmpty(f))return!0;var g=0;_.each(f,function(b,c){var d=a.find("#"+c);
d.addClass("tb_field_error");var f=e("<span/>",{"class":"tb_field_error_msg","data-error-key":c}).text(b);d.is("select")?f.insertAfter(d.closest(".selectwrapper")):f.insertAfter(d);g||(d=a.children().index(d.closest(".tb_options_tab_wrapper")),(d=-1<d&&a.closest("#tb_lightbox_parent").find(".tb_options_tab > li").eq(d))&&!d.hasClass("current")&&d.trigger("click"),++g)});return!1},checkValidate:function(a,c){return b.Forms.get_validator(a)(c)},clear:function(){if(b.activeModel&&(void 0!==b.activeModel.get("is_new")&&
b.activeModel.trigger("dom:module:unsaved"),b.activeModel=null,void 0!==tinyMCE))for(var a=tinymce.editors.length-1;-1<a;a--)"content"!==tinymce.editors[a].id&&tinyMCE.execCommand("mceRemoveEditor",!0,tinymce.editors[a].id)}};b.undoManager={stack:[],is_working:!1,index:-1,btnUndo:document.getElementsByClassName("tb_undo_btn")[0],btnRedo:document.getElementsByClassName("tb_redo_btn")[0],compactBtn:document.getElementsByClassName("tb_compact_undo")[0],init:function(){b.toolbar.$el.find(".tb_undo_redo").on("click",
this.do_change.bind(this));if(!themifyBuilder.disableShortcuts&&(e(top_iframe).on("keydown",this.keypres.bind(this)),"visual"===b.mode))e(document).on("keydown",this.keypres.bind(this))},push:function(a,c,d,f,g){b.hasChanged&&(b.editing=!1,d&&(d=ThemifyBuilderCommon.clone(d)),"visual"!==b.mode||"duplicate"!==f&&"sort"!==f||e(window).trigger("tfsmartresize.tfVideo"),this.stack.splice(this.index+1,this.stack.length-this.index),this.stack.push({cid:a,type:f,data:g,before:c,after:d}),this.index=this.stack.length-
1,this.updateUndoBtns(),"visual"===b.mode&&Themify.body.trigger("builder_dom_changed",[f]))},set:function(a){var c=a[0].querySelectorAll("[data-cid]"),c=Array.prototype.slice.call(c);c.unshift(a[0]);a=0;for(var d=c.length;a<d;++a){var f=b.Models.Registry.lookup(c[a].getAttribute("data-cid"));f&&f.trigger("change:view",c[a])}},doScroll:function(a){return a},keypres:function(a){if(90===a.which&&"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName)if(!0===a.ctrlKey&&
!0===a.shiftKey||!0===a.metaKey&&!0===a.shiftKey)a.preventDefault(),this.hasRedo()&&this.changes(!1);else if(!0===a.ctrlKey||!0===a.metaKey)a.preventDefault(),this.hasUndo()&&this.changes(!0)},changes:function(a){var c=this.stack[this.index+(a?0:1)];if(void 0!==c){this.is_working=!0;var d="";var f=c.type;var g=e(".tb_element_cid_"+c.cid);var h=ThemifyBuilderCommon;var k=!1;b.eventName=f;if("row"===f)a?(d=h.clone(c.before),k=c.cid):(d=h.clone(c.after),k=c.before.data("cid"),g=e(".tb_element_cid_"+
k)),this.doScroll(g),this.set(d),d.toggleClass("tb_row_empty",0===d.find(".active_module").length),g.replaceWith(d);else if("duplicate"===f)a?this.doScroll(e(".tb_element_cid_"+c.after.data("cid"))).remove():(this.doScroll(g),d=h.clone(c.after),k=c.before.data("cid"),this.set(d),g.after(d));else if("delete_row"===f)a?(d=h.clone(c.before),k=c.cid,h=e(".tb_element_cid_"+c.data.pos_cid),this.doScroll(h),this.set(d),"after"===c.data.pos?h.after(d):h.before(d)):this.doScroll(g).remove();else if("sort"===
f)k=c.cid,a?(g=c.data.before,d=h.clone(c.before)):(g=c.data.after,d=h.clone(c.after),"visual"===b.mode&&d.find(".active_module").css({display:"block",height:"auto"})),this.doScroll(d),this.set(d),h=e(".tb_element_cid_"+k).closest(".module_row"),e(".tb_element_cid_"+k).remove(),h.toggleClass("tb_row_empty",0===h.find(".active_module").length),h=null,e(".tb_element_cid_"+g).replaceWith(d),h=d.closest(".module_row"),h.toggleClass("tb_row_empty",0===h.find(".active_module").length),h=null;else if("row_sort"===
f){k=c.cid;var l=c.data[a?"bnext":"anext"],c=e(".tb_element_cid_"+c.data[a?"before":"after"]);g=e(".tb_element_cid_"+k);d=h.clone(g);g.remove();g=null;this.set(d);l?c.before(d):c.after(d);this.doScroll(d)}else if("save"===f){k=c.cid;var f=b.Models.Registry.lookup(k),m="module"===f.get("elType"),n=m?"mod_settings":"styling";m&&c.data.column?(a?(h=e(".tb_element_cid_"+k).closest(".module_row"),k=!1,this.doScroll(g).remove()):(k=c.data.column.data("cid"),d=h.clone(c.data.column),g=e(".tb_element_cid_"+
k),this.doScroll(g),this.set(d),g.replaceWith(d),h=d.closest(".module_row")),h.toggleClass("tb_row_empty",0===h.find(".active_module").length),h=null):(this.doScroll(g),m={},a?(d=h.clone(c.before),"visual"===b.mode&&(l=e.extend(!0,{},c.data.bstyles)),m[n]=c.data.bsettings):(d=h.clone(c.after),"visual"===b.mode&&(l=e.extend(!0,{},c.data.astyles)),m[n]=c.data.asettings),"visual"===b.mode&&b.liveStylingInstance.doUndo(l),f.set(m,{silent:!0}),m=l=null,this.set(d),g.replaceWith(d))}else if("predesign"===
f)if(g=c.data.rows,a)for(this.doScroll(e(".tb_element_cid_"+g[0].data("cid"))),l=0,f=g.length;l<f;++l)e(".tb_element_cid_"+g[l].data("cid")).remove();else{n=document.createDocumentFragment();d=[];l=0;for(f=g.length;l<f;++l)m=h.clone(g[l]),n.appendChild(m[0]),d.push(m);!1!==c.data.prev?this.doScroll(e(".tb_element_cid_"+c.data.prev)).after(n):this.doScroll("visual"===b.mode?e("#themify_builder_content-"+c.data.bid):e("#tb_row_wrapper")).prepend(n);l=0;for(f=d.length;l<f;++l)this.set(d[l]),b.Mixins.Builder.update(d[l])}else if("import"===
f){g=e('[data-postid="'+c.data.bid+'"]');var c=a?c.data.before:c.data.after,p=this,c=h.clone(c);g.children().remove();g.prepend(c);c.each(function(){p.set(e(this))})}else"grid_sort"===f&&(a?e(".tb_element_cid_"+c.cid).remove():(g=e(".tb_element_cid_"+c.before),d=h.clone(c.after),k=c.cid,c.data.next?g.before(d):g.after(d),this.set(d)));k&&b.Mixins.Builder.update(e(d));a?--this.index:++this.index;this.is_working=!1;this.updateUndoBtns();b.toolbar.pageBreakModule.countModules()}},hasRedo:function(){return this.index<
this.stack.length-1},hasUndo:function(){return-1!==this.index},disable:function(){this.btnUndo.classList.add("tb_disabled");this.btnRedo.classList.add("tb_disabled");this.compactBtn.classList.add("tb_disabled")},updateUndoBtns:function(){var a=this.hasUndo(),b=this.hasRedo();a?this.btnUndo.classList.remove("tb_disabled"):this.btnUndo.classList.add("tb_disabled");b?this.btnRedo.classList.remove("tb_disabled"):this.btnRedo.classList.add("tb_disabled");a||b?this.compactBtn.classList.remove("tb_disabled"):
this.compactBtn.classList.add("tb_disabled")},reset:function(){this.stack=[];this.index=-1;this.updateUndoBtns()},do_change:function(a){a.preventDefault();a.stopPropagation();!1!==this.is_working||a.currentTarget.classList.contains("tb_disabled")||this.changes(a.currentTarget.classList.contains("tb_undo_btn"))}};b.Forms.register_validator=function(a,b){this.Validators[a]=b};b.Forms.get_validator=function(a){return void 0!==this.Validators[a]?this.Validators[a]:this.Validators.not_empty};b.Forms.register_validator("email",
function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;a=a.split(",");return!(0<e.map(a,function(a,c){return b.test(a)?null:"1"}).length)});b.Forms.register_validator("not_empty",function(a){return!(!a||""===a.trim())});b.Views.Toolbar=Backbone.View.extend({events:{"click .tb_import":"import","click .tb_load_layout":"loadLayout","click .tb_save_layout":"saveLayout","click .tb_dup_link":"duplicate",
"click .tb_toolbar_save":"save","click .tb_toolbar_backend_edit a":"save","click .tb_toolbar_close_btn":"panelClose","click .tb_breakpoint_switcher":"breakpointSwitcher","click .tb_zoom":"zoom","click .tb_toolbar_zoom_menu_toggle":"zoom","click .tb_toolbar_builder_preview":"previewBuilder"},render:function(){setTimeout(A,1);var a=[],c=this,d=this.$el.find(".tb_module_panel_modules_wrap"),f=wp.template("builder_module_item_draggable"),g;for(g in themifyBuilder.modules)a.push(f({slug:g,name:themifyBuilder.modules[g].name,
type:themifyBuilder.modules[g].type?themifyBuilder.modules[g].type:"",favorite:+themifyBuilder.modules[g].favorite}));d[0].innerHTML=a.join("")+'<span class="favorite-separator"></span>';e("#tmpl-builder_module_item_draggable").remove();"visual"===b.mode&&e("body",top_iframe)[0].appendChild(this.el);a=f=null;setTimeout(function(){function a(){new SimpleBar(d[0]);c.pageBreakModule.init();c.preDesignedRows.init();c.libraryItems.init();c.common.init();setTimeout(function(){c.help.init()},800);setTimeout(function(){c.Revisions.init()},
1500)}c.Panel.init();b.undoManager.init();"visual"===b.mode?(window.top.jQuery("body").one("themify_builder_ready",a),c.unload()):a()},1);e("body",top_iframe).on("click",".tb_favorite",c.toggleFavoriteModule);if("visual"===b.mode)Themify.body.on("click",".tb_favorite",c.toggleFavoriteModule);this.autoFocus()},"import":function(a){a.preventDefault();a=ThemifyBuilderCommon.detectBuilderComponent(e(a.currentTarget));var c=null,d={dataType:"html",data:{action:"builder_import",type:a}};if("file"!==a||
confirm(themifyBuilder.i18n.importFileConfirm))"file"===a&&(c=function(){b.Utils.builderPlupload("",!0)}),ThemifyBuilderCommon.Lightbox.open(d,null,c)},unload:function(){"visual"===b.mode&&document.head.insertAdjacentHTML("afterbegin",'<base target="_parent">');window.top.onbeforeunload=function(){return b.editing||!b.hasChanged&&!b.undoManager.hasUndo()?null:"Are you sure"}},autoFocus:function(){this.$el.find("#tb_module_panel").on("transitionend",function(a){"visibility"===a.originalEvent.propertyName&&
"desktop"===b.activeBreakPoint&&"tb_module_panel"===a.target.getAttribute("id")&&e(this).find(".tb_module_panel_search_text").focus()})},panelClose:function(a){a.preventDefault();window.top.location.reload(!0)},loadLayout:function(a){function b(a){a.each(function(a){0===a%4?e(this).addClass("layout-column-break"):e(this).removeClass("layout-column-break")})}a.preventDefault();var d=this;ThemifyBuilderCommon.Lightbox.open(d.layouts_list?{loadMethod:"html",data:d.layouts_list}:{data:{action:"tb_load_layout"}},
null,function(a){function c(){var a=f.find(".layout_preview_list");k.show().find("a").on("click",function(c){c.preventDefault();e(this).hasClass("selected")||(c=a,e(this).hasClass("all")||(a.hide(),c=a.filter('[data-category*="'+e(this).text()+'"]')),c.show(),b(c),k.find("a").removeClass("selected"),e(this).addClass("selected"),k.parent().find(".tb_ui_dropdown_label").html(e(this).text()))});f.find("#tb_layout_search").on("keyup",function(){var c=e.trim(e(this).val()),d=a;""!==c&&(d=k.find("a.all"),
d.hasClass("selected")||d.click(),a.hide(),d=a.find(".layout_title:contains("+c+")").closest(".layout_preview_list"));d.show();b(d)})}a=e(a);var f=a.find("#tb_tabs_pre-designed"),k=f.find(".tb_ui_dropdown_items");0!==f.length&&(d.layouts_list?c():(ThemifyBuilderCommon.showLoader("show"),e.getJSON("https://themify.me/themify-layouts/index.json").done(function(g){var h=window.top.wp.template("themify-builder-layout-item"),l={},p="";g=e(h(g));g.find("li").each(function(){for(var a=String(e(this).data("category")).split(","),
b=0,c=a.length;b<c;++b)""!==a[b]&&void 0===l[a[b]]&&(p+='<li><a href="#">'+a[b]+"</a></li>",l[a[b]]=1)});l=null;k[0].insertAdjacentHTML("beforeend",p);f[0].insertAdjacentHTML("beforeend",g[0].outerHTML);a.find(".tb_tab").each(function(){b(e(this).find(".layout_preview_list"))});d.layouts_list=a[0];c();new SimpleBar(a[0])}).fail(function(a,b,c){ThemifyBuilderCommon.LiteLightbox.alert(e("#tb_load_layout_error",f).show().text())}).always(function(){ThemifyBuilderCommon.showLoader("spinhide")})))})},
saveLayout:function(a){a.preventDefault();ThemifyBuilderCommon.Lightbox.open({data:{action:"tb_custom_layout_form",postid:themifyBuilder.post_ID}},function(){b.Utils.builderPlupload("normal")})},duplicate:function(a){function c(){d.Revisions.ajax({action:"tb_duplicate_page",tb_is_admin:"visual"!==b.mode},function(a){a&&(window.top.location.href=e("<div/>").html(a).text())})}a.preventDefault();var d=this;confirm(themifyBuilder.i18n.confirm_on_duplicate_page)&&b.Utils.saveBuilder(c)},Revisions:{init:function(){b.toolbar.$el.find(".tb_revision").on("click",
this.revision.bind(this));e("body",top_iframe).on("click",".js-builder-restore-revision-btn",this.restore.bind(this)).on("click",".js-builder-delete-revision-btn",this["delete"].bind(this))},revision:function(a){a.preventDefault();a.currentTarget.classList.contains("tb_save_revision")?this.save():this.load()},load:function(){ThemifyBuilderCommon.Lightbox.open({data:{action:"tb_load_revision_lists",postid:themifyBuilder.post_ID,tb_load_nonce:themifyBuilder.tb_load_nonce}})},ajax:function(a,b){a=e.extend({},
a,{tb_load_nonce:themifyBuilder.tb_load_nonce,postid:themifyBuilder.post_ID});return e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:a,beforeSend:function(){ThemifyBuilderCommon.showLoader("show")},complete:function(){ThemifyBuilderCommon.showLoader("hide")},success:function(a){e.isFunction(b)&&b.call(this,a)}})},save:function(a){var c=this;ThemifyBuilderCommon.LiteLightbox.prompt(themifyBuilder.i18n.enterRevComment,function(d){null!==d&&b.Utils.saveBuilder(function(){c.ajax({action:"tb_save_revision",
rev_comment:d},a)},"main",0,!0)})},restore:function(a){a.preventDefault();var c=e(a.currentTarget).data("rev-id"),d=this,f=function(){d.ajax({action:"tb_restore_revision_page",revid:c},function(a){a.status?(b.Forms.reLoad(a,themifyBuilder.post_ID),ThemifyBuilderCommon.Lightbox.close()):(ThemifyBuilderCommon.showLoader("error"),alert(a.data))})};ThemifyBuilderCommon.LiteLightbox.confirm(themifyBuilder.i18n.confirmRestoreRev,function(a){"yes"===a?d.save(f):f()},{buttons:{no:{label:"Don't Save"},yes:{label:"Save"}}})},
"delete":function(a){a.preventDefault();if(confirm(themifyBuilder.i18n.confirmDeleteRev)){var b=e(a.currentTarget);a=b.data("rev-id");this.ajax({action:"tb_delete_revision",revid:a},function(a){a.success?b.closest("li").remove():(ThemifyBuilderCommon.showLoader("error"),alert(a.data))})}}},save:function(a){a.preventDefault();a.stopPropagation();var c=0<e(a.currentTarget).closest(".tb_toolbar_backend_edit").length?e(a.currentTarget).prop("href"):!1;themifyBuilder.is_gutenberg_editor&&!1!==c?(b.undoManager.reset(),
b._backendSwitchFrontend(c)):b.Utils.saveBuilder(function(a,f){"success"!==f?alert(themifyBuilder.i18n.errorSaveBuilder):!1!==c&&("visual"===b.mode?(sessionStorage.setItem("focusBackendEditor",!0),window.top.location.href=c):(b.undoManager.reset(),b._backendSwitchFrontend(c)))})},libraryItems:{items:[],is_init:null,init:function(){e(document).one("tb_panel_tab_tb_module_panel_library_wrap",this.load.bind(this))},load:function(a,c){var d=this;c=e(c).find(".tb_module_panel_library_wrap");c.addClass("tb_busy");
e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_get_library_items",nonce:themifyBuilder.tb_load_nonce,part:"all",pid:themifyBuilder.post_ID},success:function(a){d.setData(a);c.removeClass("tb_busy");d.is_init=!0},error:function(){c.removeClass("tb_busy");ThemifyBuilderCommon.showLoader("error");d.init();b.toolbar.$el.find(".tb_library_item_list").html("<h3>Failed to load Library Items.</h3>")}})},get:function(a,b,d){if(void 0!==this.items[a])d(this.items[a]);else{var c=this;e.ajax({type:"POST",
url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_get_library_item",nonce:themifyBuilder.tb_load_nonce,type:b,id:a},beforeSend:function(a){ThemifyBuilderCommon.showLoader("show")},success:function(b){ThemifyBuilderCommon.showLoader("hide");"success"===b.status?(c.items[a]=b.content,d(b.content)):ThemifyBuilderCommon.showLoader("error")},error:function(){ThemifyBuilderCommon.showLoader("error")}})}},template:function(a){for(var b="",d=0,f=a.length;d<f;++d){var g="part";-1!==a[d].post_type.indexOf("_rows",
5)?g="row":-1!==a[d].post_type.indexOf("_module",5)&&(g="module");b+='<div class="tb_library_item tb_item_'+g+'" data-type="'+g+'" data-id="'+a[d].id+'">';b+='<div class="tb_library_item_inner"><span>'+a[d].post_title+"</span>";b+='<a href="#" class="remove_item_btn" title="Delete"></a></div></div>'}return b},bindEvents:function(a){"visual"===b.mode?(b.Mixins.Builder.initModuleVisualDrag(".tb_item_module,.tb_item_part"),b.Mixins.Builder.initRowVisualDrag(".tb_item_row")):(b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_module_panel_library_wrap").first(),
".tb_item_row"),b.Mixins.Builder.initModuleDraggable(b.toolbar.$el.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"));if(b.toolbar.common.btn||"visual"===b.mode&&(b.toolbar.common.is_init||a))b.Mixins.Builder.initRowDraggable(b.toolbar.common.btn.find(".tb_module_panel_library_wrap").first(),".tb_item_row"),b.Mixins.Builder.initModuleDraggable(b.toolbar.common.btn.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part")},setData:function(a){a='<span id="no-content" style="display:none">No library content found.</span>'+
this.template(a);var c=e(".tb_library_item_list");"visual"===b.mode&&(c=c.add(b.toolbar.$el.find(".tb_library_item_list")));for(var c=c.get(),d=0,f=c.length;d<f;++d)c[d].insertAdjacentHTML("afterbegin",a),new SimpleBar(c[d]),e(c[d]).closest(".tb_module_panel_tab").find(".tb_module_types .active a").trigger("click");Themify.body.on("click",".remove_item_btn",this["delete"].bind(this));if("visual"===b.mode)e("body",top_iframe).on("click",".remove_item_btn",this["delete"].bind(this));this.bindEvents()},
"delete":function(a){a.preventDefault();a.stopPropagation();var c=e(a.currentTarget).closest(".tb_library_item"),d=c.data("type");if(confirm(themifyBuilder.i18n[d+"LibraryDeleteConfirm"])){var f=c.data("id");e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_remove_library_item",nonce:themifyBuilder.tb_load_nonce,id:f},beforeSend:function(a){ThemifyBuilderCommon.showLoader("show")},success:function(a){ThemifyBuilderCommon.showLoader("hide");a?(a=0<c.closest("#"+b.toolbar.common.btn.prop("id")).length?
b.toolbar.$el.find(".tb_item_"+d+'[data-id="'+f+'"]'):b.toolbar.common.btn.find(".tb_item_"+d+'[data-id="'+f+'"]'),c=c.add(a),"part"===d&&(c=c.add(e(".themify_builder_content-"+f).closest(".active_module")),a=b.Views.ControlRegistry.lookup("selected_layout_part"))&&(a.data=[]),c.remove()):ThemifyBuilderCommon.showLoader("error")},error:function(){ThemifyBuilderCommon.showLoader("error")}})}}},preDesignedRows:{is_init:null,rows:{},init:function(){setTimeout(function(){document.head.insertAdjacentHTML("afterbegin",
'<meta http-equiv="x-dns-prefetch-control" content="on"/><link href="//themify.me" rel="dns-prefetch preconnect"/><link href="//fonts.googleapis.com" rel="dns-prefetch"/><link href="//maps.google.com" rel="dns-prefetch"/><link href="https://themify.me/public-api/predesigned-rows/index.json" rel="prefetch"/>')},7E3);e(document).one("tb_panel_tab_tb_module_panel_rows_wrap",this.load.bind(this))},load:function(a,c){var d=this;c=e(c).find(".tb_predesigned_rows_list");c.addClass("tb_busy");e.getJSON("https://themify.me/public-api/predesigned-rows/index.json").done(function(a){d.setData(a,
c)}).fail(function(a,g,h){d.setData({},c);d.is_init=null;ThemifyBuilderCommon.showLoader("error");b.toolbar.$el.find(".tb_predesigned_rows_container").append("<h3>Failed to load Pre-Designed Rows from server.</h3>");e(document).one("tb_panel_tab_tb_module_panel_rows_wrap",d.load.bind(d))})},setData:function(a){function c(a){new SimpleBar(a);!0!==u.is_init&&("visual"===b.mode?b.Mixins.Builder.initRowVisualDrag(".predesigned_row"):b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_predesigned_rows_container").first(),
".predesigned_row"),b.toolbar.common.is_init&&b.Mixins.Builder.initRowDraggable(b.toolbar.common.btn.find(".tb_predesigned_rows_container").first(),".predesigned_row"),u.is_init=!0);e(a).closest(".tb_predesigned_rows_list").removeClass("tb_busy").closest(".tb_module_panel_tab").find(".tb_ui_dropdown").css("visibility","visible")}for(var d=[],f="",g="",h=0,k=a.length;h<k;++h){for(var l=a[h].category.split(","),m="",n=0,p=l.length;n<p;++n)-1===d.indexOf(l[n])&&d.push(l[n]),m+=" tb"+Themify.hash(l[n]);
if(void 0===a[h].thumbnail||""===a[h].thumbnail)a[h].thumbnail="https://placeholdit.imgix.net/~text?txtsize=24&txt="+encodeURI(a[h].title)+"&w=181&h=77";0===(h+1)%4&&(m+=" tb_column_break");g+='<div class="predesigned_row'+m+'" data-slug="'+a[h].slug+'"><figure class="tb_predesigned_rows_list_image">';a[h].thumbnail&&(g+='<img alt="'+a[h].title+'" title="'+a[h].title+'" src="'+a[h].thumbnail+'" />');g+='</figure><div class="tb_predesigned_rows_list_title">'+a[h].title+"</div></div>"}a=null;d.sort();
h=0;for(k=d.length;h<k;++h)f+='<li><a href="#" data-slug="'+Themify.hash(d[h])+'">'+d[h]+"</li>";a=e(".tb_row_filter");var d=e(".tb_predesigned_rows_container"),u=this;"visual"===b.mode&&(d=d.add(b.toolbar.$el.find(".tb_predesigned_rows_container")),a=a.add(b.toolbar.$el.find(".tb_row_filter")));a=a.get();d=d.get();h=0;for(k=a.length;h<k;++h)a[h].insertAdjacentHTML("beforeend",f),d[h].innerHTML=g,l=d[h].getElementsByTagName("img"),0<l.length?(l=l[l.length-1],e(l).one("load",function(){c(e(this).closest(".tb_predesigned_rows_container")[0])})):
c(d[h]);Themify.body.on("click",".tb_row_filter a",this.filter.bind(this));if("visual"===b.mode)e("body",top_iframe).on("click",".tb_row_filter a",this.filter.bind(this))},get:function(a,b){ThemifyBuilderCommon.showLoader("show");if(void 0!==this.rows[a])"function"===typeof b&&b(this.rows[a]);else{var c=this;e.getJSON("https://themify.me/public-api/predesigned-rows/"+a+".txt").done(function(d){c.rows[a]=d;"function"===typeof b&&b(d)}).fail(function(a,b,c){ThemifyBuilderCommon.showLoader("error");
alert("Failed to fetch row template")})}},filter:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget);var b=a.data("slug"),d=a.closest(".tb_modules_panel_wrap"),f=d.find(".tb_ui_dropdown_label"),g=d.find(".predesigned_row");f.text(a.text());d.find(".tb_module_panel_search_text").val("");var h=b?"tb"+b:!1;f.data("active",h);g.each(function(){!h||e(this).hasClass(h)?e(this).show():e(this).hide()}).filter(":visible").each(function(a){0===(a+1)%4?e(this).addClass("tb_column_break"):
e(this).removeClass("tb_column_break")})}},pageBreakModule:{init:function(){"visual"===b.mode?b.Mixins.Builder.initRowVisualDrag(".tb_page_break_module"):b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_module_panel_rows_wrap").first(),".tb_page_break_module")},countModules:function(){var a=1;("visual"===b.mode?jQuery(self.frameElement).contents().find(".module-page-break"):e(".module_row.tb-page-break")).each(function(){"visual"===b.mode?e(this).find(".page-break-order").text(a):e(this).find(".page-break-overlay").text("PAGE BREAK - "+
a);a+=1});a=1},get:function(a){ThemifyBuilderCommon.showLoader("show");var b=[{row_order:"0",cols:[{column_order:"0",grid_class:"col-full first last",modules:[{mod_name:"page-break",mod_settings:{}}],styling:{}}],column_alignment:"col_align_middle",styling:{custom_css_row:"tb-page-break"}},{row_order:"1",cols:[{column_order:"0",grid_class:"col-full"}]}];"function"===typeof a&&a(b)}},common:{btn:null,is_init:null,clicked:null,init:function(){this.btn=e('<div class="tb_modules_panel_wrap" id="tb_plus_btn_popover"></div>');
0<e(".edit-post-layout__content").length?e(".edit-post-layout__content").append(this.btn):Themify.body.append(this.btn);var a=this;if("visual"===b.mode)b.toolbar.$el.find(".tb_module_types a").on("click",this.tabs.bind(this));Themify.body.on("click",".tb_module_types a",this.tabs.bind(this)).on("click",".tb_row_btn_plus",this.show.bind(this));b.toolbar.$el.find(".tb_module_panel_search_text").on("keyup",this.search.bind(this));this.btn.on("click",".add_module_btn",function(c){b.toolbar.Panel.add_module(c,
a.clicked.closest(".module_row").find(".tb_holder").last());a.clicked=null;a.btn.hide()}).on("keyup",".tb_module_panel_search_text",this.search.bind(this))},run:function(){var a=b.toolbar.$el.find("#tb_module_panel");this.btn[0].insertAdjacentHTML("beforeend",a[0].innerHTML);this.btn.find(".tb_module_panel_lock").remove();this.btn.find(".tb_module_outer").show();this.btn.find(".tb_module_panel_search_text").val("");new SimpleBar(this.btn.find(".tb_module_panel_modules_wrap")[0]);b.Mixins.Builder.initModuleDraggable(this.btn,
".tb_module");b.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_rows_grid").first(),".tb_row_grid");if(b.toolbar.libraryItems.is_init||"visual"===b.mode)b.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"),b.Mixins.Builder.initRowDraggable(this.btn.find(".tb_library_item_list").first(),".tb_item_row");(b.toolbar.preDesignedRows.is_init||"visual"===b.mode)&&b.Mixins.Builder.initRowDraggable(this.btn.find(".tb_predesigned_rows_container").first(),
".predesigned_row");this.is_init=!0;b.Mixins.Builder.initRowDraggable(b.toolbar.common.btn.find(".tb_module_panel_rows_wrap").first(),".tb_page_break_module")},tabs:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget);var b=a.data("target"),d=a.closest(".tb_modules_panel_wrap");d.find("."+a.data("hide")).hide();var f=d.find("."+b),g=d.find("#no-content");0<f.length?(g.hide(),f.show()):g.show();a.closest("li").addClass("active").siblings().removeClass("active");d.find(".tb_module_panel_search_text").val("").focus();
e(document).trigger("tb_panel_tab_"+b,d)},show:function(a){a.preventDefault();a.stopPropagation();null===this.is_init&&this.run();this.clicked=e(a.currentTarget);var c=this.clicked.offset();a=c.left;c=c.top;0<e(".edit-post-layout__content").length?(a=e(".edit-post-layout__content"),c+=a.scrollTop()-70,a=a.width()/2-11):b.Forms.LayoutPart.el&&this.btn.width(b.Forms.LayoutPart.el.width());a=a-this.btn.width()/2+11;0>a&&(a=0);this.btn.css({top:c,left:a}).show();"visual"===b.mode&&"desktop"!==b.activeBreakPoint&&
(e("body",top_iframe).height(document.body.scrollHeight+this.btn.outerHeight(!0)),Themify.body.css("padding-bottom",180));"desktop"===b.activeBreakPoint&&this.btn.find(".tb_module_panel_search_text").focus();this.hide()},hide:function(){function a(d){c.btn.is(":hover")||(c.btn.hide().css("width",""),c.clicked=null,e(document).off("click",a),e(top_iframe).off("click",a),"visual"===b.mode&&"desktop"!==b.activeBreakPoint&&(e("body",top_iframe).height(document.body.scrollHeight),Themify.body.css("padding-bottom",
"")))}var c=this;if("visual"===b.mode)e(top_iframe).on("click",a);e(document).on("click",a)},search:function(a){var c=e(a.currentTarget);a=c.closest(".tb_modules_panel_wrap");var d=a.find(".tb_module_types .active").first().find("a").data("target"),f=!1,g=!1,h=!1,k=!1,c=e.trim(c.val());"tb_module_panel_modules_wrap"===d?(f=a.find(".tb_module_outer"),h=!0):"tb_module_panel_rows_wrap"===d&&b.toolbar.preDesignedRows.is_init?(g=a.find(".tb_ui_dropdown_label").data("active"),f=a.find(".predesigned_row")):
"tb_module_panel_library_wrap"===d&&(f=a.find(".tb_library_item"),g=a.find(".tb_library_types .active a").data("target"),k=!0);if(!1!==f){var l=""===c,m=l?!1:new RegExp(c,"i");f.each(function(){if(g&&!e(this).hasClass(g))return!0;var a=h?e(this).find(".module_name"):k?e(this).find(".tb_library_item_inner span"):e(this).find(".tb_predesigned_rows_list_title");l||m.test(a.text())?e(this).show():e(this).hide()})}}},help:{init:function(){this.welcome();e(".tb_help_btn",b.toolbar.$el).on("click",this.show.bind(this))},
is_clicked:null,show:function(a){a.preventDefault();a.stopPropagation();var b=this;ThemifyBuilderCommon.showLoader("show");return e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{tb_load_nonce:themifyBuilder.tb_load_nonce,action:"tb_help"},complete:function(){ThemifyBuilderCommon.showLoader("spinhide")},success:function(a){top_iframe.body.insertAdjacentHTML("beforeend",a);a=e("#tb_help_videos",top_iframe.body);e(".tb_player_btn",a).click(b.play.bind(b));e(".tb_help_menu a",a).click(b.tabs.bind(b));
e(".tb_close_lightbox",a).click(b.close.bind(b));b.is_clicked||a.slideDown()}})},play:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget).closest("a");var b=a.prop("href"),d=document.createElement("iframe");d.setAttribute("frameborder","0");d.setAttribute("allow","autoplay; fullscreen");d.setAttribute("src",b+"?rel=0&showinfo=0&autoplay=1&enablejsapi=1&html5=1&version=3");a.replaceWith(d)},tabs:function(a){a.preventDefault();a.stopPropagation();a=e(a.currentTarget);var b=e(".tb_help_video_wrapper",
top_iframe),d=b.find(a.attr("href")),f=d.find(".tb_player_btn");b.find(".tb_player_wrapper").removeClass("active").hide();d.addClass("active").show();a.closest("li").addClass("current").siblings().removeClass("current");this.stopPlay();0<f.length?f.trigger("click"):this.startPlay()},execute:function(a,b){a.contentWindow.postMessage('{"event":"command","func":"'+b+'","args":""}',"*")},stopPlay:function(){var a=this;e(".tb_player_wrapper",top_iframe).each(function(){if(!e(this).hasClass("active")){var b=
e(this).find("iframe");0<b.length&&a.execute(b[0],"pauseVideo")}})},startPlay:function(){var a=e(".tb_player_wrapper.active",top_iframe).find("iframe");0<a.length&&this.execute(a[0],"playVideo")},close:function(a,b){a.preventDefault();a.stopPropagation();e(a.currentTarget).closest(".tb_help_lightbox").slideUp("normal",function(){e(this).next(".tb_overlay").remove();e(this).empty().remove();b&&b()})},welcome:function(){var a=e("#tb_first_help");if(0<a.length){var b=this;top_iframe.body.insertAdjacentHTML("beforeend",
a[0].outerHTML+'<div class="tb_overlay"></div>');a.remove();a=e("#tb_first_help",top_iframe);a.slideDown("normal",function(){e(".tb_close_lightbox,.tb_start_building",e(this)).click(b.close.bind(b));e(".tb_player_btn,.tb_watch",e(this)).click(b.watch.bind(b));document.cookie="tb_first_on=1;expires=Tue, 19 Jan 2038 03:14:07 UTC;path=/"})}},watch:function(a){a.preventDefault();a.stopPropagation();this.is_clicked=!0;var b=this;this.show(a).done(function(){b.close(a,function(){e("#tb_help_videos",top_iframe.body).slideDown("normal",
function(){e(this).find(".tb_player_wrapper.active").find(".tb_player_btn").trigger("click");b.is_clicked=null})})})}},breakpointSwitcher:function(a){function c(){f.responsive_grids(g,l);Themify.body.trigger("themify_builder_change_mode",[l,g]);"visual"===b.mode?(b.iframe.css("will-change","auto"),b.Mixins.Builder.updateModuleSort(null,"desktop"===g?"enable":"disable"),b.Utils._onResize(!0,function(){f.iframeScroll("desktop"!==g);e("body",top_iframe).height("desktop"!==g?document.body.scrollHeight:
"auto");b.scrollTo&&setTimeout(function(){b.scrollTo&&e(window).add(top_iframe).scrollTop(b.scrollTo.offset().top);b.scrollTo=!1},500);setTimeout(function(){b.Utils.setCompactMode(document.getElementsByClassName("module_column"));k.removeClass("tb_start_animate")},200)})):k.removeClass("tb_start_animate");b.toolbar.$el.find(".tb_compact_switcher i").prop("class",h.find("i").prop("class"));k.toggleClass("tb_responsive_mode","desktop"!==g).removeClass("builder-breakpoint-"+l).addClass("builder-breakpoint-"+
g)}a.preventDefault();if(themifyBuilder.is_premium){var d="",f=this,g="desktop",h=e(a.currentTarget),k=e("body",top_iframe),l=b.activeBreakPoint;["desktop","mobile","tablet","tablet_landscape"].forEach(function(a){k.hasClass("builder-breakpoint-"+a)&&(l=a)});h.hasClass("breakpoint-tablet")?g="tablet":h.hasClass("breakpoint-tablet_landscape")?g="tablet_landscape":h.hasClass("breakpoint-mobile")&&(g="mobile");if(l===g&&void 0!==a.originalEvent)return!1;b.activeBreakPoint=g;"visual"===b.mode&&(k=k.add(Themify.body));
k.addClass("tb_start_animate");"desktop"!==g&&(d=b.Utils.getBPWidth(g)-1);if("visual"===b.mode){e(".tb_toolbar_zoom_menu",top_iframe).removeClass("tb_toolbar_zoom_active").find(".tb_toolbar_zoom_menu_toggle").data("zoom",100);a=e(".tb_workspace_container",top_iframe).width();d="tablet_landscape"===g&&a<d&&ThemifyBuilderCommon.Lightbox.dockMode.get()?a:d;if(b.isPreview){var m={tablet_landscape:themifyBuilder.breakpoints.tablet_landscape[1],tablet:themifyBuilder.breakpoints.tablet[1],mobile:themifyBuilder.breakpoints.mobile};
g in m&&(d=m[g])}b.iframe.css("width",d).parent().removeClass("tb_zoom_bg");try{if(d&&b.iframe.width()!=d)b.iframe.css("will-change","width").one(b.Utils.transitionPrefix(),c);else c()}catch(n){b.iframe.css("width",a)}}else c()}},iframeScroll:function(a){var b=e(top_iframe);b.off("scroll.themifybuilderresponsive");if(a)b.on("scroll.themifybuilderresponsive",function(){window.scrollTo(0,e(this).scrollTop())})},responsive_grids:function(a,b){for(var c=document.querySelectorAll(".row_inner,.subrow_inner"),
f="desktop"===a,g=f||"desktop"===b,h=0,k=c.length;h<k;++h){var l=c[h].getAttribute("data-basecol");if(l){var m=c[h].children,n=c[h].dataset["col_"+a],p=m[0],u=m[m.length-1];if(!f){if("desktop"!==b){c[h].classList.remove("tb_3col");var y=c[h].getAttribute("data-col_"+b);y&&c[h].classList.remove(e.trim(y.replace("tb_3col","").replace("mobile","column").replace("tablet","column")))}if(n&&"-auto"!==n){if(n=c[h].getAttribute("data-col_"+a))c[h].classList.add("tb_grid_classes"),c[h].classList.add("col-count-"+
l),n=n.split(" "),n.map(function(a){c[h].classList.add(e.trim(a.replace("mobile","column").replace("tablet","column")))})}else c[h].classList.remove("tb_grid_classes"),c[h].classList.remove("col-count-"+l)}if(g)for(l=0,n=m.length;l<n;++l)y=e(m[l]).data("w"),void 0!==y&&(m[l].style.width=f?y+"%":"");"rtl"===c[h].getAttribute("data-"+a+"_dir")?(p.classList.remove("first"),p.classList.add("last"),u.classList.remove("last"),u.classList.add("first"),c[h].classList.add("direction-rtl")):(p.classList.remove("last"),
p.classList.add("first"),u.classList.remove("first"),u.classList.add("last"),c[h].classList.remove("direction-rtl"))}}},Panel:{el:null,is_locked:!1,key:"tb_module_panel_locked",init:function(){this.el=b.toolbar.$el.find(".tb_toolbar_add_modules_wrap");this.el.find(".tb_module_panel_lock").on("click",this.lock.bind(this));this._setupModulePanelState();this.el.find(".add_module_btn").on("click",this.add_module);this.compactToolbar()},add_module:function(a,c){a.preventDefault();a.stopPropagation();c=
c||b.Instances.Builder[0].$el.find(".module_row").last().find(".tb_holder").first();var d=c.offset().top-37;"visual"===b.mode?"desktop"!==b.activeBreakPoint&&e(top_iframe).scrollTop(d):d-=50;e(window).scrollTop(d);b.Mixins.Builder.moduleDrop(e(a.currentTarget).closest(".tb_module"),c)},compactToolbar:function(){function a(){b.toolbar.$el.outerWidth()<c?top_iframe.body.classList.add("tb_compact_toolbar"):top_iframe.body.classList.remove("tb_compact_toolbar")}var c="visual"===b.mode?850:750;e(window.top).on("tfsmartresize.compact",
a);if("visual"===b.mode)window.top.jQuery("body").one("themify_builder_ready",a);else a()},resetPanel:function(){this.is_locked&&this.toggleLock()},toogle:function(a){this.is_locked||(e(a.currentTarget).focus(),"tb_module_panel_library_wrap"===b.toolbar.$el.find("ul.tb_module_types li.active a").data("target")&&e(document).trigger("change:tab:tb_module_panel_library_wrap",b.toolbar.$el.find("#tb_module_panel.tb_modules_panel_wrap")))},lock:function(a){a.preventDefault();this.is_locked=!this.is_locked;
localStorage.setItem(this.key,this.is_locked);this.toggleLock();if(!this.is_locked){this.el.addClass("tb_hide_panel");var c=this;setTimeout(function(){b.toolbar.$el.find("#tb_switch_backend").focus();c.el.removeClass("tb_hide_panel")},1E3)}},toggleLock:function(){var a=b.toolbar.$el;"visual"===b.mode&&(a=a.add(Themify.body),a.addClass("tb_remove_transitions"));e("body",top_iframe).toggleClass("tb_module_panel_locked");e(window).trigger("tfsmartresize");a.removeClass("tb_remove_transitions")},_setupModulePanelState:function(){this.is_locked=
localStorage.getItem(this.key);"false"===this.is_locked&&(this.is_locked=!1);this.is_locked&&setTimeout(this.toggleLock,1200)},hide:function(){this.el.blur();if(this.is_locked){var a=b.toolbar.$el;"visual"===b.mode&&(a=a.add(Themify.body),a.addClass("tb_remove_transitions"));e("body",top_iframe).removeClass("tb_module_panel_locked");e(window).trigger("tfsmartresize");a.removeClass("tb_remove_transitions")}},show:function(){this.is_locked||this.el.focus()}},toggleFavoriteModule:function(){var a=e(this),
c=a.closest(".tb_module_outer"),d=a.parent().data("module-slug");e.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_module_favorite",module_name:d,module_state:+!c.hasClass("favorited")},beforeSend:function(a){function f(a,c){function g(){a.removeAttr("style");if(c){var g=0<a.closest("#tb_plus_btn_popover").length?b.toolbar.$el:e("#tb_plus_btn_popover");f(g.find(".tb-module-type-"+d).closest(".tb_module_outer"),!1)}}if(a.is(":visible"))a.css({opacity:0,transform:"scale(0.5)"}).one(h,
function(){a.toggleClass("favorited").css({opacity:1,transform:"scale(1)"}).one(h,g)});else a.toggleClass("favorited"),g()}var h=b.Utils.transitionPrefix();f(c,!0)}})},zoom:function(a){function c(){b.Utils._onResize(!0)}a.preventDefault();if("desktop"!==b.activeBreakPoint)return!0;var d=e(a.currentTarget);a=d.data("zoom");var f=e(".tb_iframe",top_iframe),g=d.closest(".tb_toolbar_zoom_menu");d.hasClass("tb_toolbar_zoom_menu_toggle")?(a="100"==a?50:100,d.data("zoom",a),d=d.next("ul").find('[data-zoom="'+
a+'"]')):g.find(".tb_toolbar_zoom_menu_toggle").data("zoom",a);f.removeClass("tb_zooming_50 tb_zooming_75");d.parent().addClass("selected-zoom-size").siblings().removeClass("selected-zoom-size");"50"==a||"75"==a?(d="50"==a?2:1.25,f.addClass("tb_zooming_"+a).one(b.Utils.transitionPrefix(),c).parent().addClass("tb_zoom_bg").css("height",Math.max(window.top.innerHeight*d,600)),g.addClass("tb_toolbar_zoom_active"),b.zoomMeta.isActive=!0,b.zoomMeta.size=a,Themify.body.addClass("tb_zoom_only")):(f.addClass("tb_zooming_"+
a).one(b.Utils.transitionPrefix(),c).parent().css("height",""),g.removeClass("tb_toolbar_zoom_active"),b.zoomMeta.isActive=!1,Themify.body.removeClass("tb_zoom_only"))},previewBuilder:function(a){a.preventDefault();e(a.currentTarget).toggleClass("tb_toolbar_preview_active");b.isPreview=!b.isPreview;Themify.body.toggleClass("tb_preview_only themify_builder_active");e("body",top_iframe).toggleClass("tb_preview_parent");b.isPreview?this.Panel.hide():this.Panel.resetPanel();(function(){b.isPreview?e(".col-count-1.row_inner").each(function(){if(0===
this.getElementsByClassName("active_module").length){var a=this.getElementsByClassName("module_column")[0];if((a=b.Models.Registry.lookup(a.dataset.cid))&&0===Object.keys(a.get("styling")).length){var a=e(this).closest(".module_row"),d=b.Models.Registry.lookup(a.data("cid"));d&&0===Object.keys(d.get("styling")).length&&a.addClass("tb_hide")}}}):e(".tb_hide.module_row").removeClass("tb_hide")})();e(".builder-breakpoint-"+b.activeBreakPoint+" a.breakpoint-"+b.activeBreakPoint,top_iframe).trigger("click");
b.vent.trigger("dom:preview")}});b.Views.bindEvents=function(){ThemifyBuilderCommon.Lightbox.setup();ThemifyBuilderCommon.LiteLightbox.modal.on("attach",function(){this.$el.addClass("tb_lite_lightbox_modal")});b.Utils.mediaUploader();b.Utils.openGallery()};b.Utils={onResizeEvents:[],gridClass:"col-full col2-1 col3-1 col4-1 col5-1 col6-1 col4-2 col4-3 col3-2".split(" "),_onResize:function(a,c){var d=e._data(window,"events").resize;e(window.top).off("tfsmartresize.tb_visual").on("tfsmartresize.tb_visual",
function(a){""===tbLocalScript.fullwidth_support&&e(window).trigger("tfsmartresize.tbfullwidth").trigger("tfsmartresize.tfVideo");"function"===typeof themifyMobileMenuTrigger&&themifyMobileMenuTrigger(a)}).off("tfsmartresize.zoom").on("tfsmartresize.zoom",function(){if(b.zoomMeta.isActive){var a="50"==b.zoomMeta.size?2:1.25;e(".tb_workspace_container",top_iframe).css("height",Math.max(window.top.innerHeight*a,600))}});if(void 0!==d)for(var f=0,g=d.length;f<g;++f)void 0!==d[f].handler&&this.onResizeEvents.push(d[f].handler);
e(window).off("resize");if(a){d=e.Event("resize",{type:"resize",isTrigger:!1});f=0;for(g=this.onResizeEvents.length;f<g;++f)try{this.onResizeEvents[f].apply(window,[d,e])}catch(h){}"function"===typeof c&&c()}},_addNewColumn:function(a,c){var d=b.Views.init_column({grid_class:a.newclass,component_name:a.component});c.appendChild(d.view.render().el)},filterClass:function(a){a=a.split(" ");for(var b=[],d=0,f=a.length;d<f;++d)-1!==this.gridClass.indexOf(a[d])&&b.push(a[d]);return b.join(" ")},_getRowSettings:function(a,
c,d){var f={};d=d||"row";var g={};var h=b.Models.Registry.lookup(a.dataset.cid);if(h){a=a.getElementsByClassName(d+"_inner")[0];g=a.children;d=0;for(var k=g.length;d<k;++d){var l=b.Models.Registry.lookup(g[d].dataset.cid);if(l){var m=g[d].getElementsByClassName("tb_holder");var n={};if(0<m.length&&(m=m[0].children,m[0])){m[0].classList.contains("active_module")||(m=m[0].children);for(var p=0,u=m.length;p<u;++p){var y=b.Models.Registry.lookup(m[p].dataset.cid);if(y){var B=b.Utils.clear(y.get("mod_settings"),
!0);delete B.cid;n[p]={mod_name:y.get("mod_name"),element_id:y.get("element_id")};0<Object.keys(B).length&&(n[p].mod_settings=B);-1!==m[p].className.indexOf("module_subrow")&&(n[p]=this._getRowSettings(m[p],p,"subrow"))}}}f[d]={element_id:l.get("element_id"),column_order:d,grid_class:this.filterClass(g[d].className)};0<Object.keys(n).length&&(f[d].modules=n);B=parseFloat(g[d].style.width);0<B&&!isNaN(B)&&(f[d].grid_width=B);B=b.Utils.clear(l.get("styling"),!0);0<Object.keys(B).length&&(f[d].styling=
B)}}g={element_id:h.get("element_id"),row_order:c,cols:f,column_alignment:h.get("column_alignment"),gutter:h.get("gutter")};f={gutter:"gutter-default",column_alignment:x?"col_align_middle":"col_align_top"};c={desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_tablet_landscape:"-auto",col_tablet:"-auto",col_mobile:"-auto"};for(d in g)""!==g[d]&&null!==g[d]&&g[d]!==f[d]||delete g[d];B=b.Utils.clear(h.get("styling"),!0);for(d in c)h=e.trim(a.getAttribute("data-"+d)),void 0!==
h&&""!==h&&h!==c[d]&&(g[d]=h);0<Object.keys(B).length&&(g.styling=B)}return g},selectedGridMenu:function(a){for(var c,d,f,g,h=a.getElementsByClassName("tb_grid_menu"),k=["mobile","tablet","tablet_landscape","desktop"],l=0,m=h.length;l<m;++l)if(a=e(h[l]),c=a.data("handle"),"module"!==c){d=a.closest(".module_"+c);f=b.Models.Registry.lookup(d.data("cid"));var n=[];c=d.find("."+c+"_inner").first();var p=f.get("gutter"),u=f.get("column_alignment");g=f.get("desktop_dir");for(var y=f.get("styling"),B="",
r={},q=c[0].children,v=0,t=q.length;v<t;++v)n.push(b.Utils._getColClass(q[v].className.split(" "))),q[v].className=q[v].className.replace(/first|last/ig,""),1!==t&&(0===v?q[v].className+="rtl"===g?" last":" first":v===t-1&&(q[v].className+="rtl"===g?" first":" last"));n=a.find(".tb_grid_desktop .grid-layout-"+n.join("-"));v=n.data("col");0<n.length&&(n.parent().addClass("selected").siblings().removeClass("selected"),d.addClass("col-count-"+v),B="col-count-"+v,r["data-basecol"]=v);"ltr"!==g&&(B+=" direction-rtl");
for(v=0;4>v;++v)g=f.get(k[v]+"_dir"),"ltr"!==g&&""!==g&&(r["data-"+k[v]+"_dir"]=g,n=a.find(".tb_grid_"+k[v]+" .column-dir-"+g),n.parent().addClass("selected").siblings().removeClass("selected")),"desktop"!==k[v]&&(g=f.get("col_"+k[v]),"-auto"!==g&&""!==g&&void 0!==g&&(r["data-col_"+k[v]]=g,n=a.find(".tb_grid_"+k[v]+" .grid-layout-"+g.replace(/column|tb_3col/ig,"")),n.parent().addClass("selected").siblings().removeClass("selected")));y&&void 0!==y.row_anchor&&""!==y.row_anchor&&d.find(".tb_row_anchor").first().text(y.row_anchor);
"col_align_top"!==u&&(a.find(".column-alignment-"+u).parent().addClass("selected").siblings().removeClass("selected"),B+=" "+u);"gutter-default"!==p&&(a.find(".gutter_select").val(p),B+=" "+p);c.addClass(B).attr(r)}},clear:function(a,b,d){d=d?[]:{};for(var c in a)if(Array.isArray(a[c])){var g=this.clear(a[c],b,!0);0<g.length&&(d[c]=g)}else if("object"===typeof a[c])g=this.clear(a[c],b,!1),e.isEmptyObject(g)||(d[c]=g);else if(null!==a[c]&&void 0!==a[c]&&""!==a[c]&&"px"!==a[c]&&"pixels"!==a[c]&&"n"!==
a[c]&&"solid"!==a[c]&&"linear"!==a[c]&&"default"!==a[c]&&"|"!==a[c]){if(!(-1!==c.indexOf("_gradient-css")||"%"===a[c]&&-1!==c.indexOf("-frame_")||"cover_gradient_hover-css"===c||"background_image-css"===c||"background_image-type_gradient"===c||-1!==c.indexOf("gradient-angle")&&"180"==a[c]||-1!==c.indexOf("_padding_apply_all_padding")||-1!==c.indexOf("_margin_apply_all_margin")||-1!==c.indexOf("_border_apply_all_border")||"text_align_right"===c||"text_align_center"===c||"text_align_left"===c||"text_align_justify"===
c||"show"===a[c]&&-1!==c.indexOf("visibility_"))){if(b&&("cover_gradient_hover-gradient"===c||"background_image-gradient"===c||-1===c.indexOf("gradient-type")&&-1===c.indexOf("gradient-angle")&&-1!==c.indexOf("_gradient-gradient"))&&(g=-1!==c.indexOf("background_gradient")?c.replace("_gradient","_type").replace("-gradient",""):c.replace("-gradient","-type").replace("_gradient","_color"),"gradient"!==a[g]&&"cover_gradient"!==a[g]&&"hover_gradient"!==a[g])){g=["gradient-angle","type_image","circle-radial",
"gradient-type"];for(var h=c.replace("-gradient",""),k=0,l=g.length;k<l;++k){var m=h+"-"+g[k];void 0!==a[m]&&(a[m]=d[m]=null,delete a[m],delete d[m])}continue}d[c]=a[c]}}else"px"===a[c]&&-1!==c.indexOf("-frame_")&&(d[c]=a[c]);return d},builderPlupload:function(a,c){var d=e(".tb_plupload_upload_uic"+(c?"":"new_elemn"===a?".plupload-clone":""),top_iframe);if(0<d.length){var f=this;void 0===f.pconfig&&(f.pconfig=JSON.parse(JSON.stringify(themify_builder_plupload_init)),f.pconfig.multipart_params._ajax_nonce=
themifyBuilder.tb_load_nonce,f.pconfig.multipart_params.topost=themifyBuilder.post_ID);d.each(function(){var a=e(this),d=a.prop("id").replace("tb_plupload_upload_ui",""),k=e.extend(!0,{},f.pconfig),l=["browse_button","container","drop_element","file_data_name"];k.multipart_params.imgid=d;for(var m=0,n=l.length;m<n;++m)k[l[m]]=d+f.pconfig[l[m]];a.data("extensions")?k.filters[0].extensions=a.data("extensions"):k.filters[0].extensions=null!==b.activeModel?k.filters[0].extensions.replace(/\,zip|\,txt/,
""):"zip,txt";d=new window.top.plupload.Uploader(k);d.init();d.bind("FilesAdded",function(a,b){a.refresh();a.start();ThemifyBuilderCommon.showLoader("show")});d.bind("Error",function(a,b){var c=e(".prompt-box .show-error");e(".prompt-box .show-login").hide();c.show();0<c.length&&c.html('<p class="prompt-error">'+b.message+"</p>");e(".overlay, .prompt-box").fadeIn(500)});d.bind("FileUploaded",function(d,g,f){var h=JSON.parse(f.response);d=e("#tb_alert",top_iframe);f=200!==f.status||h.error?"error":
"done";if(h.error)ThemifyBuilderCommon.showLoader(f),alert(h.error);else if(c){var k=e("#tb_row_wrapper").children().clone(!0);d.promise().done(function(){b.Forms.reLoad(h,themifyBuilder.post_ID);var a=e("#tb_row_wrapper").children().clone(!0);ThemifyBuilderCommon.Lightbox.close();b.undoManager.push("","","","import",{before:k,after:a,bid:themifyBuilder.post_ID})})}else ThemifyBuilderCommon.showLoader(f),f=h.large_url?h.large_url:h.url,a.closest(".tb_input").find(".tb_uploader_input").val(f).trigger("change").parent().find(".img-placeholder").html(e("<img/>",
{src:h.thumb,width:50,height:50}))});a.removeClass("plupload-clone")})}},columnDrag:function(a,c,d,f){var g=this;c&&(c=a?a.children(".module_column"):e(".module_column"),c.css("width",""),g.setCompactMode(c));if(d&&f){a=a.children(".module_column");var h=("gutter-narrow"===d?1.6:"gutter-none"===d?0:3.2)-("gutter-narrow"===f?1.6:"gutter-none"===f?0:3.2),h=parseFloat(h*(a.length-1)/a.length);a.each(function(a){e(this).prop("style").width&&(a=parseFloat(e(this).prop("style").width)+h,e(this).css("width",
a+"%"))})}else{var k={"col6-1":14,"col5-1":17.44,"col4-1":22.6,"col4-2":48.4,"col2-1":48.4,"col4-3":74.2,"col3-1":31.2,"col3-2":65.6},l={"col6-1":15.33,"col5-1":18.72,"col4-1":23.8,"col4-2":49.2,"col2-1":49.2,"col4-3":74.539,"col3-1":32.266,"col3-2":66.05},m={"col6-1":16.666,"col5-1":20,"col4-1":25,"col4-2":50,"col2-1":50,"col4-3":75,"col3-1":33.333,"col3-2":66.666};(a?a.children(".module_column").find(".tb_grid_drag"):e(".tb_grid_drag")).each(function(){var a,c,d,f,h=0,r,q=!1,t=0,x=!1,A,w,E,D;e(this).draggable({axis:"x",
cursor:"col-resize",distance:0,scroll:!1,snap:!1,containment:".row_inner",helper:function(b){a=e(b.currentTarget);c=a.closest(".subrow_inner");0===c.length&&(c=a.closest(".row_inner"));c.addClass("tb_drag_column_start");r=a.hasClass("tb_drag_right")?"w":"e";A="w"===r?"tb_grid_drag_right_tooltip":"tb_grid_drag_left_tooltip";x=ThemifyBuilderCommon.clone(c.closest(".module_row"));return e('<div class="ui-widget-header tb_grid_drag_tooltip '+A+'"></div><div class="ui-widget-header tb_grid_drag_tooltip"></div>')},
start:function(b,e){d=c.children(".module_column");f=a.closest(".module_column");E=c.hasClass("direction-rtl");"w"===r?(q=E?f.prev(".module_column"):f.next(".module_column"),h=a.outerWidth(),D=f.outerWidth()):(q=E?f.next(".module_column"):f.prev(".module_column"),D=h=f.outerWidth());h=parseInt(h);t=parseInt(q.outerWidth())-2;w=c.outerWidth()},stop:function(a,h){e(".tb_grid_drag_tooltip").remove();c.removeClass("tb_drag_column_start");var n=Math.ceil(100*(f.outerWidth()/w));f.css("width",n+"%");var p=
k,n=3.2;c.hasClass("gutter-narrow")?(p=l,n=1.6):c.hasClass("gutter-none")&&(p=m,n=0);var r=n*(d.length-1);d.each(function(a){a!==q.index()&&(e(this).prop("style").width?a=parseFloat(e(this).prop("style").width):(a=e.trim(g.filterClass(e(this).attr("class")).replace("first","").replace("last","")),a=p[a]),r+=a)});q.css("width",100-r+"%");q=q.add(f);g.setCompactMode(q);n=c.closest(".module_row");b.undoManager.push(n.data("cid"),x,n,"row");Themify.body.trigger("tb_grid_changed",[n])},drag:function(a,
b){if(q&&0<q.length){var c=parseInt(b.position.left),c=h+("e"===r?-c:c),d=parseFloat(100*c/w);if(5<=d&&100>d){var e=t,e=e+("w"===r?-(c-D):D-c),k=parseFloat(100*e/w);5<k&&100>k&&(q.css("width",e+"px"),f.css("width",c+"px").children("."+A).html(d.toFixed(2)+"%"),f.children(".tb_grid_drag_tooltip").last().html(k.toFixed(2)+"%"),g.setCompactMode(f))}}}})})}},grid:function(a){var b=[];a=parseInt(a);if(1===a)b.push({grid_class:"col-full"});else for(var d=0;d<a;++d)b.push({column_order:d,grid_class:"col"+
a+"-1"});return[{row_order:"0",cols:b}]},setCompactMode:function(a){a instanceof jQuery&&(a=a.get());for(var b=0,d=a.length;b<d;++b)185>a[b].clientWidth?a[b].classList.add("compact-mode"):a[b].classList.remove("compact-mode")},initNewEditor:function(a){var b=tinyMCEPreInit.mceInit.tb_lb_hidden_editor;b.elements=a;b.selector="#"+a;return this.initMCEv4(a,b)},initMCEv4:function(a,b){if(3<parseInt(tinyMCE.majorVersion)){var c=new tinyMCE.Editor(a,b,tinyMCE.EditorManager);c.render();return c}},initQuickTags:function(a){"function"===
typeof window.top.QTags&&(window.top.quicktags({id:a}),window.top.QTags._buttonsInit())},setImageSelect:function(a){},setColorPicker:function(a){e(".minicolors-swatch",a).each(function(){var a=e(this),d=a.closest(".minicolors_wrapper");e(this).one("click",function(){var a=d.find(".minicolors-input");d.prepend(a).find(".minicolors").remove();b.hasChanged=!0;b.Views.init_control("color",{el:a,binding_type:a.data("control-binding")})}).prev(".minicolors-input").one("focusin",function(){e(this).next(".minicolors-swatch").trigger("click")});
d.find(".color_opacity").one("change",function(){a.prev(".minicolors-input").attr("data-opacity",e(this).val());a.trigger("click")})})},datePickerLoaded:null,datePicker:function(a){function b(){var b=window.top.$.fn.themifyDatetimepicker?window.top.$.fn.themifyDatetimepicker:window.top.$.fn.datetimepicker;b&&e(".themify-datepicker",a).each(function(){var a=e(this),c=a.next(".themify-datepicker-clear");c.click(function(b){b.preventDefault();b.stopPropagation();a.val("").trigger("change");e(this).addClass("disable")}).toggleClass("disable",
!a.val());b.call(a,{showButtonPanel:!0,changeYear:!0,dateFormat:a.data("dateformat")||"yy-mm-dd",timeFormat:a.data("timeformat")||"HH:mm:ss",stepMinute:5,stepSecond:5,controlType:a.data("timecontrol")||"select",oneLine:!0,separator:a.data("timeseparator")||" ",onSelect:function(b){c.toggleClass("disable",""==b);a.trigger("change")},beforeShow:function(){e("#ui-datepicker-div",top_iframe).addClass("themify-datepicket-panel")}})})}if(null===this.datePickerLoaded){var d=this;window.top.Themify.LoadCss(themifyBuilder.meta_url+
"css/jquery-ui-timepicker.min.css");window.top.Themify.LoadAsync(themifyBuilder.includes_url+"js/jquery/ui/datepicker.min.js",function(){window.top.Themify.LoadAsync(themifyBuilder.meta_url+"js/jquery-ui-timepicker.min.js",function(){d.datePickerLoaded=!0;b()},null,null,function(){return void 0!==window.top.$.fn.themifyDatetimepicker})},null,null,function(){return void 0!==window.top.$.fn.datepicker})}else b()},_getColClass:function(a){for(var b=0,d=a.length;b<d;++b)if(-1!==this.gridClass.indexOf(a[b]))return a[b].replace("col",
"")},saveBuilder:function(a,c,d,f){c=c||"main";d=d||0;0===d&&("main"===c&&b.activeModel&&e(".builder_save_button",top_iframe).trigger("click"),ThemifyBuilderCommon.showLoader("show"));var g=Object.keys(b.Instances.Builder).length,h=b.Instances.Builder[d],k=this,l=h.$el.data("postid"),h=h.toJSON();(function(a,d){d={action:"tb_save_data",tb_load_nonce:themifyBuilder.tb_load_nonce,id:a,data:JSON.stringify(d),tb_saveto:c,sourceEditor:"visual"===b.mode?"frontend":"backend"};f&&(d.only_data=f);return e.ajax({type:"POST",
url:themifyBuilder.ajaxurl,cache:!1,data:d})})(l,h).always(function(h,l){++d;g===d?(e.isFunction(a)&&a.call(k,h,l),"success"!==l?ThemifyBuilderCommon.showLoader("error"):(ThemifyBuilderCommon.showLoader("hide"),b.editing=!0,Themify.body.trigger("themify_builder_save_data",[h,l]))):setTimeout(function(){k.saveBuilder(a,c,d,f)},50)})},loadContentJs:function(a,c){ThemifyBuilderModuleJs.loadOnAjax(a,c);if(!1===b.saving){var d=e("audio.wp-audio-shortcode, video.wp-video-shortcode",a);if(0<d.length){if(themifyBuilder.media_css){for(var f in themifyBuilder.media_css)Themify.LoadCss(themifyBuilder.media_css[f]);
themifyBuilder.media_css=null}d.each(function(){var a=e(this).closest(".mejs-mediaelement");0<a.length&&(this.removeAttribute("style"),this.setAttribute("id",this.getAttribute("id").replace("_html5","")),a.closest(".widget").html(this))});d.mediaelementplayer("undefined"!==typeof window.top._wpmejsSettings?window.top._wpmejsSettings:{})}}Themify.body.trigger("builder_load_module_partial",[a,c])},mediaUploader:function(){var a={};e("body",top_iframe).on("click",".tb_media_uploader",function(c){c.preventDefault();
c.stopPropagation();var d=e(this),f=d.closest(".tb_input");c=d.data("uploader-title");var g=d.data("uploader-button-text"),d=d.data("library-type")?d.data("library-type"):"image",h=Themify.hash(d+c+g);if(void 0!==a[h])var k=a[h];else k=wp.media.frames.file_frame=wp.media({title:c,library:{type:d},button:{text:g},multiple:!1}),a[h]=k;k.off("select").on("select",function(){var a=k.state().get("selection").first().toJSON();f.find(".tb_uploader_input").val(a.url).trigger("change").parent().find(".img-placeholder").html(e("<img/>",
{src:a.url,width:50,height:50}));b.hasChanged=!0;f.find(".tb_uploader_input_attach_id").val(a.id)});k.open()}).on("click",".tb_delete_thumb",function(a){a.preventDefault();b.hasChanged=!0;e(this).prev().empty().closest(".tb_input").find(".tb_uploader_input").val("").trigger("change")}).on("click",".insert-media",function(a){b.hasChanged=!0;window.top.wpActiveEditor=e(this).data("editor")})},openGallery:function(){var a=wp.media.gallery.shortcode,c=this,d=null;e("body",top_iframe).on("click",".tb_gallery_btn",
function(f){f.preventDefault();var g=e(this).closest(".tb_input").find(".tb_shortcode_input");null===d&&(d=wp.media.frames.file_frame=wp.media({frame:"post",state:"gallery-edit",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:!1}),d.$el.addClass("themify_gallery_settings"));wp.media.gallery.shortcode=function(b){var c=b.props.toJSON(),d=_.pick(c,"orderby","order");b.gallery&&_.extend(d,b.gallery.toJSON());d.ids=b.pluck("id");c.uploadedTo&&(d.id=c.uploadedTo);d._orderbyRandom&&
(d.orderby="rand",delete d._orderbyRandom);d.ids&&"post__in"===d.orderby&&delete d.orderby;_.each(wp.media.gallery.defaults,function(a,b){a===d[b]&&delete d[b]});delete d._orderByField;b=new window.top.wp.shortcode({tag:"gallery",attrs:d,type:"single"});g.val(b.string()).trigger("change");wp.media.gallery.shortcode=a;return b};d.on("update",function(a){var d=wp.media.gallery.shortcode(a).string().slice(1,-1);g.val("["+d+"]");c.setShortcodePreview(a.models,g);b.hasChanged=!0});0<e.trim(g.val()).length?
(d=wp.media.gallery.edit(e.trim(g.val())),d.state("gallery-edit").on("update",function(a){var d=wp.media.gallery.shortcode(a).string().slice(1,-1);g.val("["+d+"]");c.setShortcodePreview(a.models,g);b.hasChanged=!0})):(d.open(),d.$el.find(".media-menu .media-menu-item").last().trigger("click"))})},setShortcodePreview:function(a,b){var c=b.next(".tb_shortcode_preview"),f="";0===c.length&&(c=e('<div class="tb_shortcode_preview"></div>'),b.after(c));for(var g=0,h=a.length;g<h;++g)var k=a[g].attributes,
f=f+('<img src="'+(k.sizes.thumbnail?k.sizes.thumbnail.url:k.url)+'" width="50" height="50" />');c[0].innerHTML=f},createRange:function(a){function c(a,c){if(a.data("increment")){var d=a.data("increment"),e=0!==d%1,g=parseFloat(a.data("max")),k=parseFloat(a.data("min")),l=a.val(),l=e?parseFloat(l||0):parseInt(l||0),d=e?parseFloat(d):parseInt(d);if("increase"===c&&l<g){if(l<k){a.val(e?parseFloat(k).toFixed(1):parseInt(k));return}a.val(e?parseFloat(l+d).toFixed(1):l+d)}else if(l>k){if(l>g){a.val(e?
parseFloat(g).toFixed(1):parseInt(g));return}a.val(e?parseFloat(l-d).toFixed(1):l-d)}b.hasChanged=!0;a.val().trim()&&a.val(e?parseFloat(a.val()).toFixed(1):parseInt(a.val()))}else h&&f.val(f.find("option").first().val()).trigger("change")}function d(b){a.data({min:b.data("min"),max:b.data("max"),increment:b.data("increment")})}var f=a.closest(".tb_range_input").next(".selectwrapper").find(".tb_unit"),g=void 0!==a[0].dataset.controlBinding?"change":"keyup",h=0<f.length&&"SELECT"===f[0].tagName;a.mousedown(function(a){var b=
a.pageY,d=this;e(window.top.document).on("mousemove.dragOnRangeInput",function(a){a.pageY<b?c(e(d),"increase"):a.pageY>b&&c(e(d),"decrease");b=a.pageY;e(d).trigger(g)}).on("mouseup.dragOnRangeInput",function(){e(this).off("mousemove.dragOnRangeInput mouseup.dragOnRangeInput");e(d).trigger(g)})}).keydown(function(a){38===a.which?c(e(this),"increase"):40===a.which&&c(e(this),"decrease")});h&&f.change(function(){d(e(this).find(":selected"));"visual"===b.mode&&"change"===g&&(E[e(this).prop("id")]=e(this).val());
a.trigger(g)});0<f.length&&d(h?f.find(":selected"):f)},createClearBtn:function(a){a.siblings(".tb_clear_btn").click(function(){e(this).hide();a.val("").trigger("keyup")})},createGradientPicker:function(a,c,d){var f=a.closest(".themify-gradient-field"),g=null,h=!1,k=a.data("id"),l=f.find("#"+k+"-gradient-angle"),m=a.prev(),n={angle:l.val(),onChange:function(c,d){h&&(c=d="");"visual"===b.mode&&("cover_gradient"===k||"cover_gradient_hover"===k?b.liveStylingInstance.addOrRemoveComponentOverlay(k,d):b.liveStylingInstance.bindBackgroundGradient(k,
d));a.val(c);b.hasChanged=!0},onInit:function(){m.show()}};n.gradient=c?c:a.data("default-gradient")?a.data("default-gradient"):void 0;d||m.ThemifyGradient(n);g=a.prev().data("themifyGradient");c=f.find("#"+k+"-gradient-type");var p=f.find("#"+k+"-circle-radial input"),u=function(a){var b=l.closest(".gradient-angle-knob"),c=f.find("#"+k+"-circle-radial");"radial"===a?(b.hide(),b.next("span").hide(),c.show()):(b.show(),b.next("span").show(),c.hide())};d?(g.settings=e.extend({},g.settings,n),g.settings.type=
c.val(),g.settings.circle=p.is(":checked"),g.isInit=!1,g.update(),g.isInit=!0):(f.find(".themify-clear-gradient").click(function(a){a.preventDefault();h=!0;g.settings.gradient=e.ThemifyGradient["default"];g.update();h=!1}),c.change(function(a){g.setType(e(this).val());u(e(this).val())}),p.change(function(){g.setRadialCircle(e(this).is(":checked"))}),l.change(function(){var a=parseInt(e(this).val());a||(a=0);g.setAngle(a)}).knob({change:function(a){g.setAngle(Math.round(a))}}),l.removeAttr("style").parent().addClass("gradient-angle-knob").find("canvas").insertAfter(l));
u(c.val())},toRGBA:function(a){var b=a.split("_"),d=/^([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/;return void 0!==b[0]?(d=d.exec(b[0].replace("#","")),b=void 0!==b[1]&&"0.99"!=b[1]?b[1]:1,d?"rgba("+parseInt(d[1],16)+", "+parseInt(d[2],16)+", "+parseInt(d[3],16)+", "+b+")":a):a},getIcon:function(a){0===a.indexOf("fa-")&&(a="fa "+a);return a},getBPWidth:function(a){a=_.isArray(themifyBuilder.breakpoints[a])?themifyBuilder.breakpoints[a]:themifyBuilder.breakpoints[a].toString().split("-");return a[a.length-
1]},transitionPrefix:function(){if(void 0===this.transitionPrefix.pre){var a=document.createElement("fakeelement"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},d;for(d in b)if(void 0!==a.style[d]){this.transitionPrefix.pre=b[d];break}}return this.transitionPrefix.pre},generateUniqueID:function(){return Math.random().toString(16).substr(2,7)},getUIDList:function(a){a=a||"row";var c=_.pluck(b.Models.Registry.items,"attributes");
return _.where(c,{elType:a})||[]}};_.extend(b.Views.BaseElement.prototype,b.Mixins.Common);_.extend(b.Views.Builder.prototype,b.Mixins.Builder);b.Views.ControlRegistry={items:{},register:function(a,b){this.items[a]=b},lookup:function(a){return this.items[a]||null},remove:function(a){this.items[a]=null;delete this.items[a]},destroy:function(){_.each(this.items,function(a,b){a.remove()});this.items={}}};b.Views.Controls["default"]=Backbone.View.extend({initialize:function(a){b.Views.ControlRegistry.register(this.$el.prop("id"),
this);a.binding_type&&(this.binding_type=a.binding_type);a.selector&&(this.selector=a.selector)},preview_element:function(a){if(void 0!==this.binding_type&&(b.hasChanged=!0,"module"===b.activeModel.get("elType"))){var c=this.$el.data("control-type");if(this.$el.closest(".tb_row_js_wrapper").length){var d=this.$el.closest(".tb_row_js_wrapper");E[d.attr("id")]=b.Forms.parseSettings(d[0]).v}else E[this.$el.prop("id")]=a;"visual"===b.mode?"live"===this.binding_type?b.activeModel.trigger("custom:preview:live",
E,"wp_editor"===c||"TEXTAREA"===this.el.tagName,null,this.selector,a,this.$el):"refresh"===this.binding_type&&b.activeModel.trigger("custom:preview:refresh",E,this.selector,a,this.$el):b.activeModel.backendLivePreview()}}});b.Views.Controls["default"].extend=function(a){var b=this,d=Backbone.View.extend.apply(this,arguments);d.prototype.events=_.extend({},this.prototype.events,a.events);d.prototype.initialize=function(){_.isFunction(b.prototype.initialize)&&b.prototype.initialize.apply(this,arguments);
_.isFunction(a.initialize)&&a.initialize.apply(this,arguments)};return d};b.Views.register_control=function(a,b){"default"!==a&&(this.Controls[a]=this.Controls["default"].extend(b))};b.Views.get_control=function(a){return this.control_exists(a)?this.Controls[a]:this.Controls["default"]};b.Views.control_exists=function(a){return this.Controls.hasOwnProperty(a)};b.Views.init_control=function(a,c){c=c||{};c.binding_type||c.el.hasClass("minicolors-input")||(c.binding_type="refresh");a?"wp_editor"===a&&
c.el.hasClass("data_control_binding_live")&&(c.binding_type="live"):a="change";var d=c.el.data("input-id");d||(d=c.el.prop("id"));return"wp_editor"!==a&&(d=this.ControlRegistry.lookup(d),null!==d)?(d.setElement(c.el).render(),d):new (b.Views.get_control(a))(c)};b.Views.register_control("wp_editor",{initialize:function(){this.render()},render:function(){var a=this,c="refresh"===this.binding_type&&void 0===this.selector?1E3:50,d=this.$el.prop("id"),f=!1,g=!1,c=_.throttle(function(c){c="setupeditor"===
this.type?this.getContent():e(this).val();null!==b.activeModel&&f!==c&&(f=c,!1!==g?a.$el.val(c).trigger("change"):a.preview_element(c))},c);b.Utils.initQuickTags(d);void 0!==tinyMCE&&void 0!==this.binding_type&&("undefined"!==typeof tinymce.editors[d]&&tinyMCE.execCommand("mceRemoveEditor",!0,d),d=b.Utils.initNewEditor(d),g=this.$el.hasClass("wp-editor-area")?0<this.$el.closest("#instance_widget").length:!1,!d.type&&(d.type="setupeditor"),d.on("change keyup",c));this.$el.on("change keyup",c);return this}});
b.Views.register_control("change",{initialize:function(){this.render()},render:function(){var a=this,b="refresh"===this.binding_type&&void 0===this.selector?1E3:50,d=this.$el.data("control-event");if(void 0===d||""===d)d="change",b=1;this.$el.on(d,_.throttle(function(b){a.preview_element(b.target.value)},b));return this}});b.Views.register_control("query_category",{initialize:function(){this.render()},render:function(){var a=this,b=a.$el.parent(),d=b.find(".query_category_single"),f=b.find(".query_category_multiple");
d.add(f).on("change",function(b){var c=(b=e(this).hasClass("query_category_single"))?d.val()+"|single":f.val()+"|multiple";b&&f.val(e(this).val());a.preview_element(c)});return this}});b.Views.register_control("layout",{initialize:function(){this.render()},render:function(){var a=this,c=this.$el.data("input-id"),d=a.$(".tfl-icon.selected").prop("id");c||(c=this.$el.prop("id"));this.$(".tfl-icon").click(function(f){f.preventDefault();var g=e(this);f=g.prop("id");g.addClass("selected").siblings().removeClass("selected");
b.hasChanged=!0;if("visual"===b.mode)if("live"===a.binding_type&&void 0!==a.$el.data("control-selector")){var g=b.liveStylingInstance.$liveStyledElmt,h=b.liveStylingInstance.getStylingVal(c);""!==a.$el.data("control-selector")&&(g=b.liveStylingInstance.$liveStyledElmt.find(a.$el.data("control-selector")));E[c]=f;"layout_feature"===c?(f="layout-"+f,h="layout-"+h):"columns"===c&&(f=c+"-"+f,h=c+"-"+h);!h&&d&&(h=d);g.removeClass(h).addClass(f);"layout_feature"===c?f=f.substr(7):"columns"===c&&(f=f.substr(8));
b.liveStylingInstance.setStylingVal(c,f);Themify.body.trigger("builder_load_module_partial",[b.liveStylingInstance.$liveStyledElmt,b.liveStylingInstance.type])}else"row_height"===c||"row_width"===c?Themify.body.trigger("tb_row_"+c.replace("row_",""),f):a.preview_element(f)});return this}});b.Views.register_control("checkbox",{initialize:function(){this.render()},render:function(){var a=this;this.$('input[type="checkbox"]').click(function(){if(void 0!==a.binding_type){var b=a.$('input[type="checkbox"]:checked').map(function(){return this.value}).get();
a.preview_element(b.join("|"))}});return this}});b.Views.register_control("color",{is_typing:!1,initialize:function(){this.render()},render:function(){var a=this,c=this.$el.next(".color_opacity"),d=this.$el.prop("id");this.$el.minicolors({opacity:1,changeDelay:200,beforeShow:function(){var b=ThemifyBuilderCommon.Lightbox.$lightbox,c=a.$el.closest(".minicolors"),d=c.find(".minicolors-panel");d.css("visibility","hidden").show();b.offset().left+b.width()<=d.offset().left+d.width()?c.addClass("tb_minicolors_right"):
c.removeClass("tb_minicolors_right");d.css("visibility","").hide()},hide:function(){var b=a.$el.siblings(".tb_clear_btn");""!==a.$el.val()?b.show():b.hide()},change:function(f,g){f?g&&"0.99"==g?g=1:g&&0>=parseFloat(g)&&(g=0):g="";a.is_typing||c.is(":focus")||c.attr("data-opacity",g).data("opacity",g).val(g);f&&0>=parseFloat(e(this).minicolors("opacity"))&&e(this).minicolors("opacity",0);var h=f?e(this).minicolors("rgbaString"):"";if(void 0!==a.binding_type)a.preview_element(h);else if("visual"===
b.mode&&(Themify.body.trigger("themify_builder_color_picker_change",[d,a.$el,f?h:""]),-1!==d.indexOf("font_color"))){var k="";"font_color"!=d&&(k="_"+d.slice(-2));var l=ThemifyBuilderCommon.Lightbox.$lightbox,h=l.find("#font_color_type"+k+"_font_gradient_color"+k+"_gradient"),k=l.find("#font_color_type"+k+"_font_color"+k+"_solid");k.length&&h.length&&(h.click(),k.click())}}}).minicolors("show");a.el.parentNode.insertAdjacentHTML("beforeend",'<div class="tb_clear_btn"></div>');b.Utils.createClearBtn(a.$el);
c.on("blur keyup",function(b){var c=parseFloat(e.trim(e(this).val()));if(1<c||isNaN(c)||""===c||0>c)c=a.$el.val()?1:"","blur"===b.type&&e(this).val(c);e(this).attr("data-opacity",c);a.is_typing="keyup"===b.type;a.$el.minicolors("opacity",c)})}});b.Views.register_control("repeater",{events:{"click .toggle_row":"toggleField","click .tb_duplicate_row":"duplicateRowField","click .tb_delete_row":"deleteRowField"},initialize:function(){this.render()},render:function(){var a=this.$el,b=this,d=!1;a.sortable({items:".tb_repeatable_field",
handle:".tb_repeatable_field_top",axis:"y",placeholder:"tb_state_highlight",tolerance:"pointer",cursor:"move",start:_.debounce(function(b,c){void 0!==tinyMCE&&a.find(".tb_lb_wp_editor").each(function(){var a=e(this).prop("id"),b=tinymce.get(a).getContent();e(this).data("content",b);tinyMCE.execCommand("mceRemoveEditor",!1,a)})},300),stop:_.debounce(function(c,g){void 0!==tinyMCE&&a.find(".tb_lb_wp_editor").each(function(){var a=e(this).prop("id");tinyMCE.execCommand("mceAddEditor",!1,a);tinymce.get(a).setContent(e(this).data("content"))});
d&&(g.item.removeClass("collapsed").find(".tb_repeatable_field_content").show(),d=!1);a.find(".tb_state_highlight").remove();b.preview_element()},300),sort:function(b,c){a.find(".tb_state_highlight").height(30)},beforeStart:function(a,b,c){c.item.hasClass("collapsed")||(c.item.addClass("collapsed").find(".tb_repeatable_field_content").hide(),d=!0,b.sortable("refresh"))}});return this},toggleField:function(a){a.preventDefault();e(a.currentTarget).closest(".tb_repeatable_field").toggleClass("collapsed").find(".tb_repeatable_field_content").slideToggle()},
duplicateRowField:function(a){a.preventDefault();a.stopPropagation();this.$el.next(".add_new").find("a").trigger("click",e(a.currentTarget).closest(".tb_repeatable_field"));this.preview_element()},deleteRowField:function(a){a.preventDefault();a.stopPropagation();confirm(themifyBuilder.i18n.rowDeleteConfirm)&&(e(a.currentTarget).closest(".tb_repeatable_field").remove(),this.preview_element())}});b.Views.register_control("widget_select",{data:null,cache:[],mediaInit:null,textInit:null,initialize:function(){this.render()},
search:function(){var a=this;this.$el.closest(".tb_input").find("#widgets-search").focus(this.show.bind(this)).blur(function(b){b.relatedTarget&&"available-widgets"===b.relatedTarget.id||a.hide()}).keyup(function(){a.$el.show();for(var b=e(this).val().trim(),d=new RegExp(b,"i"),f=a.el.getElementsByClassName("widget-tpl"),g=0,h=f.length;g<h;++g)if(""===b)f[g].style.display="block";else{var k=f[g].getElementsByTagName("h3")[0],k=k.textContent||k.innerText;d.test(k)?f[g].style.display="block":f[g].style.display=
"none"}})},show:function(){this.$el.next(".tb_field_error_msg").remove();this.$el.parent().show()},hide:function(){this.$el.parent().hide()},select:function(a,c){var d=this,f=a.data("value"),g=a.data("idbase"),h=e("#instance_widget",ThemifyBuilderCommon.Lightbox.$lightbox),k=function(a){var k=function(){var k=e(a.form);h.addClass("open").html(k.html());if(c)for(var l in c)k.find('[name="'+l+'"]').val(c[l]);k=null;"text"===g?wp.textWidgets&&(d.textInit||(d.textInit=!0,wp.textWidgets.init()),c&&delete wp.textWidgets.widgetControls[c["widget-id"]]):
wp.mediaWidgets&&(d.mediaInit||(wp.mediaWidgets.init(),d.mediaInit=!0),c&&delete wp.mediaWidgets.widgetControls[c["widget-id"]]);e(document).trigger("widget-added",[h]);"text"===g&&b.Views.init_control("wp_editor",{el:h.find(".wp-editor-area"),binding_type:"refresh"});c?setTimeout(function(){new SimpleBar(top_iframe.getElementById("tb_options_setting"));new SimpleBar(d.el)},100):"visual"===b.mode&&f&&h.find(":input").first().trigger("change");h.removeClass("tb_loading_widgets_form").find("select").wrap('<span class="selectwrapper"/>')},
l=function(b,c){var d=b.length;(function(b,c){Themify.LoadAsync(b,c,a.v)})(b[c].src,function(){if(b[c].extra&&b[c].extra.after){var a=b[c].extra.after,e="";if("object"===typeof a)for(var f in a)a[f]&&(e+=a[f]);""!==e&&(a=document.createElement("script"),a.type="text/javascript",a.text=e,e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(a,e))}++c;c<d?l(b,c):k()})};void 0===d.cache[g]?(a.template&&document.body.insertAdjacentHTML("beforeend",a.template),0<a.src.length?l(a.src,0):
k()):k()};E.class_widget=f;h.addClass("tb_loading_widgets_form").html('<i class="fa fa-refresh fa-spin"></i>');e.each(c,function(a,b){var d=a.match(/.*\[\d\]\[(.*)\]/);e.isArray(d)&&"undefined"!==d[1]&&(delete c[a],c[d[1]]=b)});e.ajax({type:"POST",dataType:"json",url:themifyBuilder.ajaxurl,data:{action:"module_widget_get_form",tb_load_nonce:themifyBuilder.tb_load_nonce,load_class:f,tpl_loaded:1===d.cache[g]?1:0,id_base:g,widget_instance:c},success:function(a){a&&a.form&&(k(a),d.cache[g]=1)}})},render:function(){var a=
this,c=b.activeModel.get("mod_settings"),d=a.$el.closest(".tb_input").find("#widgets-search"),f=d.prev(".tb_loading_widgets"),g=function(){function g(b,c){b.addClass("selected").siblings().removeClass("selected");a.select(b,c);a.$el.removeAttr("data-validation");d.val(b.find(".widget-title").text());a.hide();a.$el.find(".widget-tpl").show()}var h=c[a.$el.prop("id")];a.el.insertAdjacentHTML("afterbegin",a.data);h?(h=a.$el.find('[data-value="'+h+'"]'),g(h,c.instance_widget)):new SimpleBar(a.el);a.$el.find(".widget-tpl").click(function(){g(e(this),
null)});a.search();f.remove();f=null;b.hasChanged=!0};f.show();if(null===this.data){for(var h in themifyBuilder.widget_css)window.top.Themify.LoadCss(themifyBuilder.widget_css[h]);themifyBuilder.widget_css=null;e.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_get_widget_items",nonce:themifyBuilder.tb_load_nonce},success:function(b){a.data=b;g()}})}else setTimeout(g,1);return this}});b.Views.register_control("widget_form",{initialize:function(){this.render()},render:function(){var a=
this;this.$el.on("change",":input",function(){a.preview_element(a.$el.find(":input").themifySerializeObject())});return this}});b.Views.register_control("layout_part",{data:[],get:function(a){var b=this;e.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_get_library_items",nonce:themifyBuilder.tb_load_nonce,pid:themifyBuilder.post_ID},beforeSend:function(a){ThemifyBuilderCommon.showLoader("show")},success:function(c){ThemifyBuilderCommon.showLoader("hide");b.data=c;a()},
error:function(){ThemifyBuilderCommon.showLoader("error")}})},initialize:function(){this.render()},render:function(){function a(){for(var a="<option></<option>",e=b.activeModel.get("mod_settings")[c.$el.prop("id")],g=0,h=c.data.length;g<h;++g)a+="<option"+(e===c.data[g].post_name?' selected="selected"':"")+' value="'+c.data[g].post_name+'">'+c.data[g].post_title+"</option>";c.el.insertAdjacentHTML("afterbegin",a);c.$el.change(function(){c.preview_element(this.value)})}var c=this;0===this.data.length?
this.get(a):a();return this}})})(jQuery);
