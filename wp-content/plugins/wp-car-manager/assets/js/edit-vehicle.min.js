jQuery(function(a){a("select#make").change(function(){var b=a(this).find("option:selected").val(),c=a("select#model");c.find("option").remove().end().append(a("<option>").val(0).html("Select Model")),jQuery.post(ajaxurl,{action:"wpcm_admin_get_models",make:b,nonce:a("#wpcm-ajax-nonce").val()},function(b){if(void 0!=b&&""!=b&&0!=b&&b.length>0)for(var d=0;d<b.length;d++)c.append(a("<option>").val(b[d].id).html(b[d].name))})}),a(".wpcm-date-field").datepicker({yearRange:"1910:+1",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});var b,c=a("#car_gallery"),d=a("#car_images_container ul.car_images");jQuery(".add_car_images").on("click","a",function(e){var f=a(this);if(e.preventDefault(),b)return void b.open();b=wp.media.frames.car_gallery=wp.media({title:f.data("choose"),button:{text:f.data("update")},states:[new wp.media.controller.Library({title:f.data("choose"),filterable:"all",multiple:!0})]}),b.on("select",function(){var a=b.state().get("selection"),e=c.val();a.map(function(a){if(a=a.toJSON(),a.id){e=e?e+","+a.id:a.id;var b=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url;d.append('<li class="image" data-attachment_id="'+a.id+'"><img src="'+b+'" /><ul class="actions"><li><a href="#" class="delete" title="'+f.data("delete")+'">'+f.data("text")+"</a></li></ul></li>")}}),c.val(e)}),b.open()}),d.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,placeholder:"wpcm-sortable-placeholder",forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style")},update:function(){var b="";a("#car_images_container ul li.image").css("cursor","default").each(function(){var a=jQuery(this).attr("data-attachment_id");b=b+a+","}),c.val(b)}}),a("#car_images_container").on("click","a.delete",function(){a(this).closest("li.image").remove();var b="";return a("#car_images_container ul li.image").css("cursor","default").each(function(){var a=jQuery(this).attr("data-attachment_id");b=b+a+","}),c.val(b),a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style"),!1})});